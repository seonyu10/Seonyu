if (self.CavalryLogger) { CavalryLogger.start_js(["Thaa0"]); }

__d("ComposerXContextConfig",[],(function a(b,c,d,e,f,g){f.exports={propertyNames:{actorID:"ACTOR_ID",postID:"POST_ID"},propertyValues:{ACTOR_ID:"actorID",POST_ID:"postID"}}}),null);
__d("ComposerXAttachmentBootstrap",["csx","cx","CSS","Form","FormSubmit","Parent","URI"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j=[],k={bootstrap:function l(m){k.load(c("Parent").byTag(m,"form"),m.getAttribute("data-endpoint"))},load:function l(m,n,o){var p=new(c("URI"))(n).addQueryData({composerurihash:k.getURIHash(n)});c("CSS").conditionClass(m,"_fu",o);var q=c("Parent").bySelector(m,"._2_4");c("CSS").removeClass(q,"async_saving");c("Form").setDisabled(m,false);m.action=p.toString();c("FormSubmit").send(m)},getURIHash:function l(m){if(m==="initial")return"initial";var n=j.indexOf(m);if(n!==-1)return n+"";else{n=j.length;j[n]=m;return n+""}}};f.exports=k}),null);
__d("ComposerXContext",["invariant","ComposerXContextConfig"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=function i(k){return c("ComposerXContextConfig").propertyNames[k]};function j(k){"use strict";this.$ComposerXContext1={};for(var l in k)this.setProperty(l,k[l])}j.prototype.getProperty=function(k){"use strict";i(k)||h(0);return this.$ComposerXContext1[k]};j.prototype.setProperty=function(k,l){"use strict";i(k)||h(0);this.$ComposerXContext1[k]=l;return this};j.PROPERTIES=c("ComposerXContextConfig").propertyValues;f.exports=j}),null);
__d("ComposerXSessionIDInserter",["csx","cx","ComposerXSessionIDs","DOM","DOMQuery","Event","Parent","onEnclosingPageletDestroy"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j={init:function k(l){var m=c("Event").listen(l,"submit",j._onSubmit);c("onEnclosingPageletDestroy")(l,function(){m.remove()})},_onSubmit:function k(l){j.insertSessionInput(l.getTarget())},insertSessionInput:function k(l){__p&&__p();var m=c("Parent").bySelector(l,"._119");if(!m)return;var n=c("ComposerXSessionIDs").getSessionID(m.id);if(!n)return;var o=c("DOMQuery").scry(l,"._5r_b")[0];if(!o)c("DOM").prependContent(l,c("ComposerXSessionIDs").createSessionIDInput(n));else o.value=n}};f.exports=j}),null);
__d("ComposerX",["csx","cx","ActorURI","Arbiter","ComposerXAttachmentBootstrap","ComposerXContext","ComposerXMarauderLogger","ComposerXSessionIDs","ComposerXSessionIDInserter","ComposerXStore","CSS","DOM","DOMQuery","PrivacyConst","PrivacySelector","PrivacySelectorNewDispatcher","URI","SubscriptionsHandler","getObjectValues","removeFromArray"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j="any";function k(l){"use strict";__p&&__p();this._root=l;this._composerID=l.id;this._attachments={};this._context=new(c("ComposerXContext"))({});c("ComposerXSessionIDs").resetSessionID(this._composerID);c("ComposerXSessionIDInserter").init(this._root);this._subscriptionsHandler=new(c("SubscriptionsHandler"))();this._subscriptionsHandler.addSubscriptions(c("Arbiter").subscribe(["composer/publish","composer/close"],function(m,n){if(n.composer_id===this._composerID){this.reset();var o=c("DOMQuery").scry(l,".hidden_target_specs");if(o&&o.length)o.forEach(c("DOM").remove);c("Arbiter").inform("composer/publishDone",n)}}.bind(this)));this._subscriptionsHandler.addSubscriptions.apply(this._subscriptionsHandler,c("ComposerXMarauderLogger").listenForPostEvents(this._composerID,this._getContent()));this._attachmentFetchForm=c("DOMQuery").find(l,"._2_4");c("Arbiter").inform("composer/ready",{},c("Arbiter").BEHAVIOR_STATE)}k.prototype.getAttachment=function(l,m,n,o){"use strict";l=this._augmentURI(l);var p=c("ComposerXAttachmentBootstrap").getURIHash(l);this._endpointHashToShow=p;var q=this._attachments[p];if(q&&!o)this._showAttachmentAfterComponentsLoaded(p,n);else this.fetchAttachmentData(l,m,o)};k.prototype.fetchAttachmentData=function(l,m,n){"use strict";l=this._augmentURI(l);var o=c("ComposerXAttachmentBootstrap").getURIHash(l);if(this._attachments[o]&&!n)return;if(!this._currentFetchEndpoints.includes(o)){c("ComposerXAttachmentBootstrap").load(this._attachmentFetchForm,l,m);this._currentFetchEndpoints.push(o)}};k.prototype.setAttachment=function(l,m,n,o){"use strict";c("removeFromArray")(this._currentFetchEndpoints,l);this._setupAttachment(l,m,n,o);this._showAttachmentAfterComponentsLoaded(l,false)};k.prototype.setInitialAttachment=function(l,m,n,o,p){"use strict";if(p)this._context=p;l=this._augmentURI(l);var q=c("ComposerXAttachmentBootstrap").getURIHash(l);this._setupAttachment(q,m,n,o);this._initialAttachmentEndpoint=l;if(!this._currentInstance)this._showAttachmentAfterComponentsLoaded(q,true)};k.prototype.setComponent=function(l,m){"use strict";if(!c("ComposerXStore").get(this._composerID,l)){c("ComposerXStore").set(this._composerID,l,m);c("DOM").appendContent(this._attachmentFetchForm,c("DOM").create("input",{type:"hidden",name:"loaded_components[]",value:l}))}};k.prototype.reset=function(){"use strict";__p&&__p();if(this._currentInstance){this._currentInstance.cleanup();this._currentInstance=null}c("ComposerXSessionIDs").resetSessionID(this._composerID);for(var l in this._attachments)this._attachments[l].instance.reset();var m=c("ComposerXStore").getAllForComposer(this._composerID);c("getObjectValues")(m).forEach(function(q){if(q.reset)q.reset(q)});var n=c("PrivacySelector").getAdamaSelectorInstance(c("DOM").scry(this._root,"div._1lo2")[0]),o=c("ComposerXStore").get(this._composerID,"mainprivacywidget"),p=o&&o.instance&&o.instance.getInstance();if(n)p.setInstance(n);else n=p&&p.getInstance();if(n&&n.shouldReplaceOnPost())c("PrivacySelectorNewDispatcher").handleUpdateFromSelector({selector_type:c("PrivacyConst").PrivacyField.CURRENT_COMPOSER.toString(),post_param:"",unique_id:"_reloadStickySelectors",reload:true});this.getAttachment(this._initialAttachmentEndpoint,false,true);c("Arbiter").inform("composer/reset")};k.prototype.destroy=function(){"use strict";this._subscriptionsHandler.release()};k.prototype.addPlaceholders=function(l,m){"use strict";__p&&__p();var n;for(var o in this._attachments){n=this._attachments[o];if(n.instance===l){m.forEach(function(p){n.placeholders.push(p);n.required_components.push(p.component_name)});break}}if(this._currentInstance===l)this._fillPlaceholders(m)};k.prototype.hasAttachmentWithClassName=function(l){"use strict";return c("DOMQuery").scry(this._root,"."+l).length>0};k.prototype.showAttachmentThrobber=function(){"use strict";c("CSS").addClass(this._attachmentFetchForm,"async_saving")};k.prototype.hideAttachmentThrobber=function(){"use strict";c("CSS").removeClass(this._attachmentFetchForm,"async_saving")};k.prototype.getContext=function(){"use strict";return this._context};k.prototype.getID=function(){"use strict";return this._composerID};k.prototype._setupAttachment=function(l,m,n,o){"use strict";m.setComposerID(this._composerID);this._attachments[l]={instance:m,placeholders:n,required_components:o};var p=this._getContent(),q=m.getRoot();if(q.parentNode!==p){c("CSS").hide(q);c("DOM").appendContent(p,q)}};k.prototype._getContent=function(){"use strict";return c("DOMQuery").find(this._root,"div._55d0")};k.prototype._showAttachment=function(l,m,n,o){"use strict";__p&&__p();if(this._currentInstance===l)return;if(this._endpointHashToShow===j)this._endpointHashToShow=null;else if(this._endpointHashToShow!==m)return;if(this._currentInstance){if(!this._currentInstance.canSwitchAway())return;this._currentInstance.cleanup()}this._currentInstance=l;var p=this._getContent().childNodes,q=l.getRoot();for(var r=0;r<p.length;r++)if(p[r]!==q)c("CSS").hide(p[r]);c("CSS").show(q);this._fillPlaceholders(n);l.initWithComponents(o);this._setAttachmentSelectedClass(l.attachmentClassName);c("Arbiter").inform("composer/initializedAttachment",{composerRoot:this._root,isInitial:o})};k.prototype._showAttachmentAfterComponentsLoaded=function(l,m){"use strict";var n=this._attachments[l];c("ComposerXStore").waitForComponents(this._composerID,n.required_components,this._showAttachment.bind(this,n.instance,l,n.placeholders,m))};k.prototype._fillPlaceholders=function(l){"use strict";l.forEach(function(m){var n=c("ComposerXStore").get(this._composerID,m.component_name);if(n.element&&m.element!==n.element.parentNode)c("DOM").setContent(m.element,n.element)}.bind(this))};k.prototype._setAttachmentSelectedClass=function(l){"use strict";__p&&__p();var m=c("DOMQuery").scry(this._root,"._519b")[0],n;if(m){c("CSS").removeClass(m,"_519b");n=c("DOMQuery").scry(m,'*[aria-pressed="true"]')[0];if(n)n.setAttribute("aria-pressed","false")}if(l){var o=c("DOMQuery").scry(this._root,"."+l)[0];if(o){c("CSS").addClass(o,"_519b");n=c("DOMQuery").scry(o,'*[aria-pressed="false"]')[0];if(n)n.setAttribute("aria-pressed","true")}}};k.prototype._augmentURI=function(l){"use strict";var m=this._context.getProperty(c("ComposerXContext").PROPERTIES.ACTOR_ID),n=m?c("ActorURI").create(l,m):new(c("URI"))(l),o=this._context.getProperty(c("ComposerXContext").PROPERTIES.POST_ID);if(o)n.addQueryData("post_id",o);return n.toString()};Object.assign(k.prototype,{_endpointHashToShow:j,_currentFetchEndpoints:[],_initialAttachmentEndpoint:""});f.exports=k}),null);
__d("registerForLeaveWarning",["fbt","Run","URI","createCancelableFunction"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(k){var l=c("URI").getNextURI(),m=c("createCancelableFunction")(k);c("Run").onBeforeUnload(function(){return j(m,l)});return m}function j(k,l){__p&&__p();var m=c("URI").getMostRecentURI(),n=c("URI").getNextURI(),o=Object.prototype.hasOwnProperty.call(m.getQueryData(),"theater")&&l.path===n.path,p=Object.prototype.hasOwnProperty.call(n.getQueryData(),"theater"),q=b.DialogNavigationStack&&b.DialogNavigationStack.isActiveURI(n);if(o||p||q){c("Run").onAfterLoad(function(){c("Run").onBeforeUnload(function(){return j(k,l)})});return}if(b.Dialog&&b.Dialog.getCurrent())return;if(k())return h._("\uc544\uc9c1 \uae00\uc744 \uc62c\ub9ac\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. \uc62c\ub9ac\uc9c0 \uc54a\uace0 \ub098\uac00\uc2dc\uaca0\uc5b4\uc694?")}f.exports=i}),null);
__d("ComposerXController",["csx","cx","invariant","ActorURI","Arbiter","ComposerX","ComposerXAttachmentBootstrap","ComposerXContext","ComposerXMarauderLogger","Event","Parent","$","emptyFunction","ge","registerForLeaveWarning"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k={},l={},m={};function n(r){var s=c("ge")(r);if(!s)return null;var t=c("Parent").bySelector(c("$")(r),"._119"),u=t.id;if(!m[u])m[u]=new(c("ComposerX"))(t);return m[u]}function o(r){var s=n(r);s!==null||j(0);return s}function p(r){if(!l[r])return;l[r].forEach(function(s){return s.cancel()});delete l[r]}var q={registerConditionForComposerCancel:function r(s,t){var u=o(s).getID();if(!(u in k))k[u]=[];k[u].push(t);if(!(u in l))l[u]=[];l[u].push(c("registerForLeaveWarning")(t))},hasChanges:function r(s){var t=k[s];if(!t)return false;return t.some(function(u){return u()})},getAttachment:function r(s,t,u,v){var w=o(s);w.getAttachment(t,u,null,v)},fetchAttachmentData:function r(s,t,u){o(s).fetchAttachmentData(t,u)},setAttachment:function r(s,t,u,v,w){var x=n(s);if(x)x.setAttachment(t,u,v,w)},setInitialAttachment:function r(s,t,u,v,w,x){var y=o(s);y.setInitialAttachment(t,u,v,w,x)},setComponent:function r(s,t,u){var v=n(s);if(v)v.setComponent(t,u)},reset:function r(s){var t=o(s);t.reset()},holdTheMarkup:c("emptyFunction"),getEndpoint:function r(s,t,u){var v=o(s),w=v.getContext();t=c("ActorURI").create(t,w.getProperty(c("ComposerXContext").PROPERTIES.ACTOR_ID)).toString();c("ComposerXAttachmentBootstrap").load(v._attachmentFetchForm,t,u)},addPlaceholders:function r(s,t,u){var v=o(s);v.addPlaceholders(t,u)},hasAttachmentWithClassName:function r(s,t){var u=o(s);return u.hasAttachmentWithClassName(t)},showAttachmentThrobber:function r(s){var t=o(s);t.showAttachmentThrobber()},hideAttachmentThrobber:function r(s){var t=o(s);t.hideAttachmentThrobber()},logEventForElement:function r(s,t){if(!c("Parent").bySelector(c("$")(s),"._119"))return;c("Event").listen(s,"click",function(){var u=q.getComposerID(s);c("ComposerXMarauderLogger").logEvent(t,u)})},getComposerID:function r(s){return o(s).getID()},destroyComposer:function r(s){if(!(s in m))return;m[s].destroy();delete m[s];delete k[s];p(s)}};c("ComposerXAttachmentBootstrap").bootstrap=function(r){q.getAttachment(r,r.getAttribute("data-endpoint"))};c("Arbiter").subscribe("page_transition",function(){for(var r in m)if(!c("ge")(r))q.destroyComposer(r)});f.exports=q}),null);
__d("ComposerXAjaxEndpoint",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ADS_MEDIA_UPLOAD:"/ajax/ads/create/composerx/attachment/media/upload/",ADS_ATTACHMENT_STATUS:"/ajax/ads/create/composerx/attachment/status/",MEDIA_UPLOAD:"/ajax/composerx/attachment/media/upload/",VIDEO_UPLOAD:"/ajax/composerx/attachment/video/upload/"})}),null);
__d("isAnimatedGif",["Promise"],(function a(b,c,d,e,f,g){__p&&__p();var h=1e6;function i(m){return m[0]===71&&m[1]===73&&m[2]===70}function j(m,n){return m[n]===0&&m[n+1]===33&&m[n+2]===249&&m[n+3]===4&&m[n+8]===0&&(m[n+9]===44||m[n+9]===33)}function k(m){__p&&__p();if(!i(m))return false;var n=0;for(var o=0;o+9<m.length;++o){if(j(m,o))n++;if(n>1)return true}return false}function l(m){__p&&__p();return new(c("Promise"))(function(n){__p&&__p();var o=new FileReader();o.onloadend=function(r){if(r.target.readyState==FileReader.DONE){var s=new Uint8Array(r.target.result);if(k(s))n(true);else n(false)}};o.onerror=function(r){n(false)};var p=Math.min(h,m.size),q=m.slice(0,p);o.readAsArrayBuffer(q)})}f.exports=l}),null);
__d("ComposerXMediaUploadHandler",["fbt","Arbiter","AsyncRequest","ComposerXAjaxEndpoint","ComposerXController","CSS","Dialog","ImageExtensions","QE","ReloadPage","SubscriptionsHandler","URI","VideoUploadConfig","VideoUploadFile","isAnimatedGif"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("ComposerXAjaxEndpoint").MEDIA_UPLOAD,j="/ajax/composerx/attachment/video/upload/",k=0;function l(m,n){"use strict";this.$ComposerXMediaUploadHandler1=m;this.$ComposerXMediaUploadHandler2=n}l.prototype.fetchAttachments=function(){"use strict";[this.getPhotoUploadAttachmentEndpoint(),j].forEach(function(m){c("ComposerXController").fetchAttachmentData(this.$ComposerXMediaUploadHandler1,m)}.bind(this))};l.prototype.handleFileSelected=function(m){"use strict";var n=this;l.isVideoOrAnimatedGifAsync(m,function(o){if(o)n.handleVideoSelected(m);else n.handlePhotoSelected(m)})};l.canUploadAnimatedGIF=function(){"use strict";return c("ImageExtensions").GIF in c("VideoUploadConfig").videoExtensions};l.isVideoOrAnimatedGifAsync=function(m,n){"use strict";var o=c("VideoUploadFile").getExtensionFromFileInput(m.getInput());if(l.canUploadAnimatedGIF()&&o===c("ImageExtensions").GIF)c("isAnimatedGif")(m.getInput().files[0]).then(n);else if(c("VideoUploadConfig").videoExtensions[o])n(true);else n(false)};l.prototype.handleVideoSelected=function(m){"use strict";__p&&__p();if(this.$ComposerXMediaUploadHandler2&&this.$ComposerXMediaUploadHandler2.imagesOnly){var n=new(c("Dialog"))().setModal(true).setButtons([c("Dialog").OK]);if(this.$ComposerXMediaUploadHandler2.isEditComposer)n.setTitle(h._("\ub3d9\uc601\uc0c1\uc744 \ucd94\uac00\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")).setBody(h._("Sorry, you can't add a video to a post you're editing."));else n.setTitle(h._("\uc798\ubabb\ub41c \uc774\ubbf8\uc9c0 \ud30c\uc77c")).setBody(h._("\uc720\ud6a8\ud55c \uc774\ubbf8\uc9c0 \ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc\ud558\uc138\uc694."));n.show();return}c("ComposerXController").getAttachment(this.$ComposerXMediaUploadHandler1,j);c("Arbiter").inform("ComposerXFilesStore/filesAdded/"+this.$ComposerXMediaUploadHandler1+"/videoupload",{fileInput:m},c("Arbiter").BEHAVIOR_PERSISTENT)};l.prototype.handlePhotoSelected=function(m){"use strict";c("ComposerXController").getAttachment(this.$ComposerXMediaUploadHandler1,this.getPhotoUploadAttachmentEndpoint());l.$ComposerXMediaUploadHandler3(this.$ComposerXMediaUploadHandler1,m)};l.isVideoFile=function(m){"use strict";var n=c("VideoUploadFile").getExtensionFromFileInput(m.getInput());return!!c("VideoUploadConfig").videoExtensions[n]};l.prototype.$ComposerXMediaUploadHandler4=function(){"use strict";return this.$ComposerXMediaUploadHandler2?this.$ComposerXMediaUploadHandler2.photoUploadOverrideEndpoint:null};l.prototype.getPhotoUploadAttachmentEndpoint=function(){"use strict";var m=this.$ComposerXMediaUploadHandler4();return m?m:i};l.$ComposerXMediaUploadHandler3=function(m,n){"use strict";c("Arbiter").inform("ComposerXFilesStore/filesAdded/"+m+"/mediaupload",{fileInput:n,receivedBySubscriber:false},c("Arbiter").BEHAVIOR_PERSISTENT)};l.setupFileUploadToComposerDialog=function(m,n,o,p){"use strict";__p&&__p();var q="composerxmediauploadhandler"+k++,r=function r(u){c("CSS").conditionClass(m.getControl(),o,u);m.getInput().disabled=u},s=new(c("URI"))(n),t=s.getQueryData();t.client_ref=q;s.setQueryData(t);n=s.toString();m.subscribe("change",function(){new(c("AsyncRequest"))().setURI(n).setErrorHandler(function(){m.clear();r(false)}).send();r(true)});c("Arbiter").subscribe("composer/dialog/"+q+"/new",function(u,v){this.$ComposerXMediaUploadHandler3(v.composerID,m);var w=new(c("SubscriptionsHandler"))();w.addSubscriptions(c("Arbiter").subscribe("composer/publish",function(event,x){if(p&&v.composerID===x.composer_id)c("ReloadPage").now()}),v.dialog.subscribe("hide",function(){w.release();m.clear();r(false)}))}.bind(this))};f.exports=l}),null);
__d("ReminderStoryUtils",["CSS","Event"],(function a(b,c,d,e,f,g){var h={hideOnClick:function i(j,k){c("Event").listen(k,"click",function(){c("CSS").hide(j)})}};f.exports=h}),null);
__d("XFamilyMentionsNUXDialogController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/family_mentions/nux_dialog/",{__asyncDialog:{type:"Int"}})}),null);
__d("FamilyRelationshipMentions",["AsyncDialog","AsyncRequest","FamilyMentionsData","XFamilyMentionsNUXDialogController"],(function a(b,c,d,e,f,g){__p&&__p();var h=function(){__p&&__p();var i={},j=false;i.shouldShowNUX=function(k){if(c("FamilyMentionsData").hasAcceptedNUX||j)return false;var l=k.family_names;if(l==undefined)return false;for(var m=0;m<l.length;m++)if(l[m]==k.text)return true;return false};i.showNUX=function(k,l){__p&&__p();var m=c("XFamilyMentionsNUXDialogController").getURIBuilder().getURI();c("AsyncDialog").send(new(c("AsyncRequest"))(m),function(n){n.subscribe("cancel",function(){k.text=k.default_name;new(c("AsyncRequest"))().setURI("/ajax/family_mentions/deny_nux").send();l(k)});n.subscribe("confirm",function(){j=true;new(c("AsyncRequest"))().setURI("/ajax/family_mentions/confirm_nux").send();l(k);n.finishHide()})})};return i}();f.exports=h}),null);
__d("TypeaheadBestName",["FamilyMentionsData","TokenizeUtil"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this._typeahead=i}h.prototype.enable=function(){"use strict";__p&&__p();var i=this._typeahead.getView(),j=this._getAvailableAlternateNameFields();this._subscription=i.subscribe("beforeRender",function(k,l){__p&&__p();var m=l.value;for(var n=0;n<l.results.length;++n){var o=l.results[n],p=this._getNameToDisplay(o,m,j);if(p!==null){o.text=p;if(Object.prototype.hasOwnProperty.call(o,"default_name")&&o.text!==o.default_name)o.subtext=o.default_name;else o.subtext=null}}}.bind(this))};h.prototype.disable=function(){"use strict";this._typeahead.getView().unsubscribe(this._subscription);this._subscription=null};h.prototype._getNameToDisplay=function(i,j,k){"use strict";__p&&__p();if(Object.prototype.hasOwnProperty.call(i,"default_name")&&c("TokenizeUtil").isQueryMatch(j,i.default_name))return i.default_name;for(var l=0;l<k.length;l++){var m=i[k[l]];if(m==undefined)continue;for(var n=0;n<m.length;n++){var o=m[n];if(c("TokenizeUtil").isQueryMatch(j,o))return o}}if(Object.prototype.hasOwnProperty.call(i,"default_name"))return i.default_name;return null};h.prototype._getAvailableAlternateNameFields=function(){"use strict";var i=["alternate_names"];if(c("FamilyMentionsData").allowFamilyNames)i.push("family_names");return i};Object.assign(h.prototype,{_subscription:null});f.exports=h}),null);
__d("legacy:BestNameTypeaheadBehavior",["TypeaheadBestName"],(function a(b,c,d,e,f,g){if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.buildBestAvailableNames=function(h){h.enableBehavior(c("TypeaheadBestName"))}}),3);
__d("MentionsInputMatchers",[],(function a(b,c,d,e,f,g){__p&&__p();var h=["@","\\uff20"].join(""),i=["#","\\uFF03"].join(""),j=".,+*?$|#{}()\\^\\-\\[\\]\\\\/!%'\"~=<>_:;\n\r",k=j.replace("#","")+"&",l="\u200b";function m(p,q){"use strict";this.$Matchers1=p;this.$Matchers2=q;this.$Matchers3()}m.prototype.$Matchers3=function(){"use strict";var n=this.$Matchers4(this.$Matchers2),p=this.$Matchers5(this.$Matchers1,this.$Matchers2),q=this.$Matchers6(this.$Matchers1,p),r=this.$Matchers7(n,q),s=this.$Matchers8(n);this.$Matchers9=new RegExp("["+this.$Matchers1+"]$");this.$Matchers10=new RegExp(q+"$");this.$Matchers11=new RegExp(s+"$");this.$Matchers12=new RegExp(r+"$");this.$Matchers13=new RegExp("["+i+"]")};m.prototype.$Matchers4=function(p){"use strict";return"\\b[A-Z][^ A-Z"+p+l+"]"};m.prototype.$Matchers5=function(p,q){"use strict";return"(?:[^"+p+q+"]|["+q+"][^ "+q+"])"};m.prototype.$Matchers6=function(p,q){"use strict";return"(?:^|\\s)(["+p+"]("+q+"{0,20}))"};m.prototype.$Matchers7=function(n,p){"use strict";return"(?:(?:^|[^#])("+n+"+)|"+p+")"};m.prototype.$Matchers8=function(n){"use strict";return"(?:"+n+"{4,})"};m.prototype.getMainMatcher=function(){"use strict";return this.$Matchers10};m.prototype.getTriggerMatcher=function(){"use strict";return this.$Matchers9};m.prototype.getAutoMatcher=function(){"use strict";return this.$Matchers12};m.prototype.getHashtagMatcher=function(){"use strict";return this.$Matchers13};var n="\\b[A-Z][^ A-Z"+j+"]",o={mentionsMatchers:new m(h,j),hashtagMatchers:new m(i,k),userMatcher:new RegExp("(?:"+n+"{4,})$")};f.exports=o}),null);
__d("htmlize",["htmlSpecialChars"],(function a(b,c,d,e,f,g){function h(i){return c("htmlSpecialChars")(i).replace(/\r\n|[\r\n]/g,"<br/>")}f.exports=h}),null);
__d("MentionsInput",["cx","Arbiter","ArbiterMixin","Bootloader","CSS","DataStore","DOM","Event","FbtResultBase","FlipDirection","Input","InputSelection","Keys","MentionsInputMatchers","Parent","Style","TokenizeUtil","UserAgent_DEPRECATED","htmlize","mixin","removeFromArray"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k="\u200b",l=new RegExp(k,"g"),m=function m(v){return v+k},n=function n(v){return v.replace(/(@+)(\[[0-9]+\:([^\]]|\\\])*\]+)/g,"$1 $2")},o=/[\\\]:]/g,p={MENTIONS:"mentions",HASHTAGS:"hashtags"};function q(v,w){return v.replace(w," ".repeat(w.length))}function r(v,w){return v.substring(0,w)+v.substring(w+1)}function s(v){var w=v.lastIndexOf(">");if(w>=0){var x=v.indexOf(" ",w);return x>=0?v.substr(0,x+1):v}else return""}function t(v,w,x){var y=x.lastIndexOf("<",w)>x.lastIndexOf(">",w);return y?" ":"&nbsp;<wbr />"}i=babelHelpers.inherits(u,c("mixin")(c("ArbiterMixin")));j=i&&i.prototype;function u(v,w,x,y,z,A){"use strict";__p&&__p();j.constructor.call(this);c("DataStore").set(v,"MentionsInput",this);this._root=v;this._typeahead=w;this._input=x;this._offsets=[];var B=null,C=this.init.bind(this,y,z,A);try{B=document.activeElement===this._input}catch(D){}if(B)setTimeout(C,0);else var E=c("Event").listen(this._input,"focus",function(){setTimeout(C,0);E.remove()});this._hasHashtags=y.hashtags;this._mentionsDataSource=this._typeahead.getData();this._currentDataSource=this._mentionsDataSource;this._autoSuggestPages=y.autosuggest_pages;this._lastHighlighterHTML="";this._hashtags=[];this._matchers=c("MentionsInputMatchers").mentionsMatchers;this._matchersMode=p.MENTIONS}u.prototype.init=function(v,w,x){"use strict";__p&&__p();if(this._initialized)return;this._initValue=w?w.value:"";this._highlighter=c("DOM").find(this._root,".highlighter");this._highlighterInner=this._highlighter.firstChild;this._highlighterContent=c("DOM").find(this._root,".highlighterContent");this._hiddenInput=c("DOM").find(this._root,".mentionsHidden");this._placeholder=this._input.getAttribute("placeholder")||"";this._metrics=x;if(!this._hiddenInput.name){var y=this._input.name;this._input.name=y+"_text";this._hiddenInput.name=y}this._initEvents();this._initTypeahead();if(w===null)this._setup();else this.reset(w);this.inform("init",null,c("Arbiter").BEHAVIOR_STATE);this._initialized=true};u.prototype._setup=function(){"use strict";__p&&__p();this._mentioned={};this._orderedUIDs=[];this._numMentioned=0;this._filterData=null;this._highlighterContent&&c("DOM").empty(this._highlighterContent);this._highlighterAuxContent&&c("DOM").remove(this._highlighterAuxContent);this._highlighterAuxContent=null;c("Input").setPlaceholder(this._input,this._placeholder);c("Style").set(this._typeahead.getElement(),"height","auto")};u.prototype.reset=function(v){"use strict";__p&&__p();this._setup();var w=v&&v.value||"";this._value=w;this._hiddenInput&&(this._hiddenInput.value=w);if(this._input&&v)c("Input").setValue(this._input,v.value);var x=v&&v.mentions;if(x&&x.length){var y=[];x.forEach(function(z){y.push(z.offset+z.length);delete z.offset;delete z.length;this._addToken(z)},this);y.reverse().forEach(function(z){w=w.substring(0,z)+k+w.substring(z)})}c("Input").setValue(this._input,w);if(this._value==="")c("FlipDirection").setDirection(this._input);this._update()};u.prototype.getValue=function(){"use strict";return c("Input").getValue(this._input).replace(l,"")};u.prototype._getMarkedValue=function(){"use strict";return c("Input").getValueRaw(this._input)};u.prototype.getRawValue=function(){"use strict";this._update();return c("Input").getValue(this._hiddenInput)};u.prototype.checkValue=function(){"use strict";var v=this._typeahead.getCore().getValue();if(this._matchers.getTriggerMatcher().exec(v)||v==="")this.inform("sessionEnd",{})};u.prototype.getTypeahead=function(){"use strict";return this._typeahead};u.prototype.hasChanges=function(){"use strict";return!c("Input").isEmpty(this._input)&&this._input.value!==this._initValue&&this._initialized};u.prototype.focus=function(){"use strict";this._input.focus()};u.prototype._initEvents=function(){"use strict";__p&&__p();var v=this._update.bind(this);c("Event").listen(this._input,{input:v,keyup:v,change:v,blur:this._handleBlur.bind(this),focus:this._handleFocus.bind(this),keydown:this._handleKeydown.bind(this)});if(this._metrics){this._metrics.init(this._typeahead);this._metrics._reset();this._metrics.bindSessionStart(this._typeahead,"render",true);this._metrics.bindSessionEnd(this._typeahead.getView(),"select",true);this._metrics.bindSessionEnd(this,"sessionEnd",false);c("Event").listen(this._input,"keyup",function(event){setTimeout(this.checkValue.bind(this),0)}.bind(this))}};u.prototype._initTypeahead=function(){"use strict";__p&&__p();this._typeahead.subscribe("select",function(A,B){var C=B.selected;this._addToken({uid:C.uid,text:C.text,type:C.type,weakreference:C.weak_reference});this.updateValue()}.bind(this));var v=this._input,w=null;function x(){if(w===null){w=c("Input").getSubmitOnEnter(v);c("Input").setSubmitOnEnter(v,false)}}function y(){if(w!==null){c("Input").setSubmitOnEnter(v,w);w=null}}this._typeahead.subscribe("reset",y);this._typeahead.subscribe("render",x);this._typeahead.subscribe("highlight",function(A,B){B.index>=0?x():y()});this._typeahead.subscribe("query",function(){this._filterData=null}.bind(this));var z=this._typeahead.getCore();z.suffix=k;this._handleFocus()};u.prototype._handleBlur=function(){"use strict";if(this._filterToken){this._filterToken.remove();this._filterToken=null}};u.prototype._handleFocus=function(){"use strict";if(!this._filterToken)this._filterToken=this._typeahead.getData().addFilter(this._filterResults.bind(this));this._updateWidth()};u.prototype._handleKeydown=function(event){"use strict";var v=event.keyCode;if(v==c("Keys").BACKSPACE||v==c("Keys").DELETE)this._handleBackspaceAndDelete(event,v);if(v==c("Keys").LEFT||v==c("Keys").RIGHT)setTimeout(this._handleLeftAndRight.bind(this,v),10)};u.prototype._handleLeftAndRight=function(v){"use strict";__p&&__p();var w=this._getMarkedValue(),x=c("InputSelection").get(this._input),y=x.start,z=x.end,A=v==c("Keys").LEFT,B=v==c("Keys").RIGHT;if(y==z){var C=A?-1:1;if(w.charAt(y)==k)c("InputSelection").set(this._input,y+C)}else if(A&&w.charAt(y)==k)c("InputSelection").set(this._input,y-1,z);else if(A&&w.charAt(z)==k)c("InputSelection").set(this._input,y,z-1);else if(B&&w.charAt(z)==k)c("InputSelection").set(this._input,y,z+1);else if(B&&w.charAt(y)==k)c("InputSelection").set(this._input,y+1,z)};u.prototype._handleBackspaceAndDelete=function(event,v){"use strict";__p&&__p();var w=c("InputSelection").get(this._input),x=false;if(w.start!==w.end)if(this._offsetIsInsideMention(w.start+1)&&this._offsetIsInsideMention(w.end))x=v===c("Keys").BACKSPACE;else return;var y=v===c("Keys").DELETE?1:-1,z=y+(x?w.end:w.start),A=this._getMarkedValue(),B=A;for(var C=0;C<this._orderedUIDs.length;++C){var D=this._mentioned[this._orderedUIDs[C]],E=D.text,F=m(E),G=B.indexOf(F),H=G+F.length;if(z<G||z>=H){B=q(B,F);continue}var I,J;if(D.type!="user"){I=0;J=[E]}else{I=F.substring(0,z-G).split(" ").length-1;J=E.split(" ")}var K=J.splice(I,1)[0],L=J.join(" "),M=I===0?G:H-K.length-1;if(L){D.text=L;L=m(L)}else this._removeToken(D.uid);var N=A.substring(0,G)+L+A.substring(H);c("Input").setValue(this._input,N);c("InputSelection").set(this._input,M);this._update();event.kill();break}};u.prototype._offsetIsInsideMention=function(v){"use strict";for(var w=0;w<this._offsets.length;w++)if(v>this._offsets[w][0]&&v<=this._offsets[w][1])return true;return false};u.prototype._filterResults=function(v){"use strict";__p&&__p();if(this._filterData===null){var w=c("InputSelection").get(this._input).start;if(this._offsetIsInsideMention(w)){this._filterData={caretIsInsideMention:true};return false}var x=this._typeahead.getCore();this._filterData={value:x.getValue(),rawValue:x.getRawValue()}}if(this._filterData.caretIsInsideMention)return false;if(this._matchers.getMainMatcher().test(this._filterData.rawValue))return true;if(v.type!="user"&&!v.connected_page)return false;if(v.disable_autosuggest)return false;if(this._matchersMode===p.MENTIONS&&c("MentionsInputMatchers").userMatcher.test(this._filterData.value))return true;return c("TokenizeUtil").isExactMatch(this._filterData.value,this._typeahead.getData().getTextToIndex(v))};u.prototype._addToken=function(v){"use strict";__p&&__p();var w=v.uid;if(!Object.prototype.hasOwnProperty.call(this._mentioned,w)){this._mentioned[w]=v;var x=this._orderedUIDs,y=n(this._getMarkedValue()),z=y.indexOf(m(this._mentioned[w].text)),A=false,B=0;for(var C=0;C<x.length;++C){var D=m(this._mentioned[x[C]].text),E=y.indexOf(D,B);B=E+D.length;if(z<E){this._orderedUIDs.splice(C,0,w);A=true;break}}if(!A)this._orderedUIDs.push(w);this._numMentioned++;this._update()}};u.prototype._removeToken=function(v){"use strict";if(Object.prototype.hasOwnProperty.call(this._mentioned,v)){delete this._mentioned[v];c("removeFromArray")(this._orderedUIDs,v);this._numMentioned--;this._update()}};u.prototype._update=function(v){"use strict";__p&&__p();v=v||{};var w=this._getMarkedValue();this._checkShouldSwapDataSource(w);if(w==this._value)return;this._value=w;this._updateTypeahead();this._updateMentions();this._updateWidth();setTimeout(this._updateDirection.bind(this),0);this.updateValue();var x=this.hasAuxContent(),y=this._hiddenInput.value;this.inform("valueUpdate",{value:w,hasAuxContent:x,textWithMentions:y})};u.prototype._updateMentions=function(){"use strict";__p&&__p();this._offsets=[];var v=this._getMarkedValue(),w=v;for(var x=0;x<this._orderedUIDs.length;++x){var y=this._orderedUIDs[x],z=m(this._mentioned[y].text),A=w.indexOf(z);if(A==-1)this._removeToken(y);w=q(w,z);this._offsets.push([A,A+z.length])}var B=v;while((A=w.indexOf(k))>-1){B=r(B,A);w=r(w,A)}if(v!==B){var C=c("InputSelection").get(this._input);c("Input").setValue(this._input,B);c("InputSelection").set(this._input,C.start);this._value=B}};u.prototype._renderHashtags=function(v){"use strict";__p&&__p();this._initHashtagParser(v);if(!this._hasHashtags||!this._hashtagParser)return c("htmlize")(v);this._hashtags=this._hashtagParser.parse(v);var w=[],x=0;for(var y=0;y<this._hashtags.length;y++){var z=this._hashtags[y];w.push(c("htmlize")(v.substring(x,z.rawOffset)),"<b>",z.marker,z.tag,"</b>");x=z.rawOffset+z.marker.length+z.tag.length}w.push(c("htmlize")(v.substring(x)));return w.join("")};u.prototype.updateValue=function(){"use strict";__p&&__p();var v=this._value=this._getMarkedValue(),w=this._orderedUIDs,x=n(v);for(var y=0;y<w.length;++y){var z="@["+w[y]+":]",A=m(this._mentioned[w[y]].text);x=x.replace(A,z);v=v.replace(A,z)}var B=this._renderHashtags(v);for(var y=0;y<w.length;++y){var C=w[y],D=this._mentioned[C],E=D.text,F=D.weakreference?'<b class="weak">':"<b>";B=B.replace("@["+C+":]",F+c("htmlize")(m(E))+"</b>");E=E.replace(o,function(H){return"\\"+H});x=x.replace("@["+C+":]","@["+C+":"+E+"]")}var G=s(B);if(this._highlighterAuxContent||G!==this._lastHighlighterHTML){if(c("UserAgent_DEPRECATED").ie()<9)B=B.replace(/ /g,t);this._highlighterContent.innerHTML=B;this._updateHighlighter();this._lastHighlighterHTML=G}this._hiddenInput.value=x;this._updateHeight()};u.prototype._updateDirection=function(){"use strict";var v=c("Style").get(this._input,"direction");if(v==this._dir)return;this._dir=v;c("Style").set(this._highlighter,"direction",v);if(v=="rtl")c("Style").set(this._highlighter,"text-align","right");else c("Style").set(this._highlighter,"text-align","left")};u.prototype._updateWidth=function(){"use strict";var v=this._input.offsetWidth;if(v===this._lastInputWidth)return;this._lastInputWidth=v;var w=c("Style").getFloat.bind(null,this._input),x=v-w("paddingLeft")-w("paddingRight")-w("borderLeftWidth")-w("borderRightWidth");this._highlighterInner.style.width=Math.max(x,0)+"px"};u.prototype._updateHeight=function(){"use strict";if(this._highlighterAuxContent){var v=this._highlighter.offsetHeight,w=this._typeahead.getElement();if(v>w.offsetHeight){this._typeahead.setHeight(v);c("Arbiter").inform("reflow")}}};u.prototype._updateTypeahead=function(){"use strict";var v=this._typeahead.getCore();v.matcher=this._matchers.getAutoMatcher();v.setExclusions(this._orderedUIDs);this.inform("update",{mentioned:this._mentioned})};u.prototype.setPlaceholder=function(v){"use strict";this._placeholder=v instanceof c("FbtResultBase")?v.toString():v;if(!this.hasAuxContent())c("Input").setPlaceholder(this._input,this._placeholder)};u.prototype._updateHighlighter=function(){"use strict";if(this._highlighterContent)c("CSS").conditionShow(this._highlighterContent,this._numMentioned>0||this.hasAuxContent()||this._hashtags.length)};u.prototype.setAuxContent=function(v){"use strict";__p&&__p();if(this._highlighterContent){if(!this._highlighterAuxContent){this._highlighterAuxContent=c("DOM").create("span",{className:"highlighterAuxContent"});c("DOM").insertAfter(this._highlighterContent,this._highlighterAuxContent)}c("DOM").setContent(this._highlighterAuxContent,v);if(v)c("Input").setPlaceholder(this._input,"");else c("Input").setPlaceholder(this._input,this._placeholder);this._value=null;this._update();this._updateHighlighter();this._updateHeight()}};u.prototype.hasAuxContent=function(){"use strict";var v=this.getAuxContentRoot();return v&&c("CSS").shown(v)&&v.innerHTML.length>0};u.prototype.getAuxContentRoot=function(){"use strict";return this._highlighterAuxContent};u.prototype.addMention=function(v,w){"use strict";w=typeof w==="undefined"?true:w;var x=w===false?"":" ",y=this._getMarkedValue();if(y!=="")y+=" ";c("Input").setValue(this._input,y+m(v.text)+x);this._addToken(v);this._update()};u.prototype.getMentions=function(){"use strict";return this._mentioned};u.prototype.bootloadHashtagParser=function(){"use strict";if(!this._hashtagParser)c("Bootloader").loadModules(["HashtagParser"],function(v){this._hashtagParser=v;if(this._initialized){this._value=null;this._update()}}.bind(this),"MentionsInput")};u.getInstance=function(v){"use strict";var w=c("Parent").byClass(v,"uiMentionsInput");return w?c("DataStore").get(w,"MentionsInput"):null};u.prototype._checkShouldSwapDataSource=function(v){"use strict";this._initHashtagParser(v)};u.prototype._initHashtagParser=function(v){"use strict";if(this._hashtagParser)return;if(this._matchers.getHashtagMatcher().exec(v))this.bootloadHashtagParser()};f.exports=u}),null);
__d("legacy:MentionsInput",["MentionsInput"],(function a(b,c,d,e,f,g){b.MentionsInput=c("MentionsInput")}),3);
__d("MentionsTypeaheadAreaView",["ContextualTypeaheadView","FamilyRelationshipMentions","Parent"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("ContextualTypeaheadView"));i=h&&h.prototype;j.prototype.getContext=function(){"use strict";return c("Parent").byClass(this.element,"uiMentionsInput")};j.prototype.shouldValidateTypeaheadSelection=function(k){"use strict";return c("FamilyRelationshipMentions").shouldShowNUX(k)};j.prototype.validateTypeaheadSelection=function(k,l){"use strict";c("FamilyRelationshipMentions").showNUX(k,l)};function j(){"use strict";h.apply(this,arguments)}f.exports=j}),null);
__d("TypeaheadAreaCore",["InputSelection","TextAreaControl","TypeaheadCore","emptyFunction"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("TypeaheadCore"));i=h&&h.prototype;function j(k){"use strict";i.constructor.call(this,k);this.matcher=new RegExp(this.matcher+"$");this.preventFocusChangeOnTab=true}j.prototype.select=function(k){"use strict";i.select.call(this,k);var l=this.element.value,m=this.prefix+k.text+this.suffix;this.expandBounds(l,m);var n=l.substring(0,this.start),o=l.substring(this.end);this.element.value=n+m+o;c("InputSelection").set(this.element,n.length+m.length)};j.prototype.expandBounds=function(k,l){"use strict";__p&&__p();k=k.toLowerCase();l=l.toLowerCase();var m,n,o,p,q=/\s/;n=k.substring(this.start,this.end);o=l.indexOf(n);m=this.start;while(m>=0&&o>=0){p=k.charAt(m-1);if(!p||q.test(p))this.start=m;n=p+n;o=l.indexOf(n);m--}n=k.substring(this.start,this.end);o=l.indexOf(n);m=this.end;while(m<=k.length&&o>=0){p=k.charAt(m);if(!p||q.test(p))this.end=m;n=n+p;o=l.indexOf(n);m++}};j.prototype.getRawValue=function(){"use strict";var k=c("InputSelection").get(this.element).start||0;return i.getValue.call(this).substring(0,k)};j.prototype.getValue=function(){"use strict";__p&&__p();var k=this.matcher&&this.matcher.exec(this.getRawValue());if(!k)return"";var l=k[0],m=k.index+l.length;l=l.replace(/^\s/,"");var n=l.length;l=l.replace(/\s$/,"");var o=n-l.length;this.start=m-n;this.end=m+o;if(k[2]&&(k[2].charAt(0)==="#"||k[2].charAt(0)==="\\uFF03"))return k[2];return k[3]||k[1]||k[0]};j.prototype.updateHeight=function(){"use strict";var k=c("TextAreaControl").getInstance(this.element);k.updateHeight()};Object.assign(j.prototype,{prefix:"",suffix:", ",matcher:"\\b[^,]*",click:c("emptyFunction")});f.exports=j}),null);
__d("TypeaheadHoistFriends",[],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this._typeahead=i}h.prototype.enable=function(){"use strict";__p&&__p();var i=this._typeahead.getView();this._subscription=i.subscribe("beforeRender",function(j,k){__p&&__p();var l=[],m=[],n=[];for(var o=0;o<k.results.length;++o){var p=k.results[o];if(p.type=="header"){n=n.concat(m,l);n.push(p);m=[];l=[]}else if(p.type=="user"&&p.bootstrapped)m.push(p);else l.push(p)}k.results=n.concat(m,l)})};h.prototype.disable=function(){"use strict";this._typeahead.getView().unsubscribe(this._subscription);this._subscription=null};Object.assign(h.prototype,{_subscription:null});f.exports=h}),null);
__d("legacy:HoistFriendsTypeaheadBehavior",["TypeaheadHoistFriends"],(function a(b,c,d,e,f,g){if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.hoistFriends=function(h){h.enableBehavior(c("TypeaheadHoistFriends"))}}),3);
__d("TypeaheadMetrics",["AsyncRequest","Event","QueriesHistory","emptyFunction"],(function a(b,c,d,e,f,g){__p&&__p();var h=1e3;function i(j){"use strict";this.extraData={};Object.assign(this,j)}i.prototype.init=function(j){"use strict";this.init=c("emptyFunction");this._initImpl(j)};i.prototype._initImpl=function(j){"use strict";__p&&__p();this.core=j.getCore();this.view=j.getView();this.data=j.getData();this.queriesHistory=new(c("QueriesHistory"))(h);this.stats={};this.sessionActive=false;this._sessionStartEvents=[];this._sessionEndEvents=[];this._reset();this.initEvents()};i.prototype._reset=function(){"use strict";__p&&__p();this.log=[];this.stats={};this.avgStats={};this.sessionActive=false;this._setSid(Math.floor(Date.now()*Math.random()));this.request_ids=[];this.lastNotBackspacedQuery="";this.queriesHistory.reset();this._logEvent("session_started",{})};i.prototype._logEvent=function(j,k){"use strict";var l={type:j,data:k,time:Date.now()};this.log.push(l)};i.prototype._setSid=function(j){"use strict";this.sid=j;if(typeof this.data.queryData==="object"&&this.data.queryData!==null)this.data.queryData.sid=this.sid;else this.data.setQueryData({sid:this.sid});if(typeof this.data.bootstrapData==="object"&&this.data.bootstrapData!==null)this.data.bootstrapData.sid=this.sid;else this.data.setBootstrapData({sid:this.sid})};i.prototype.resetWithData=function(j){"use strict";this.init=c("emptyFunction");this._initImpl(j)};i.prototype.resetWithDataBeforeSessionEnd=function(j){"use strict";var k=this.sessionActive;this.init=c("emptyFunction");this._initImpl(j);this.sessionActive=k};i.prototype.recordSelect=function(j){"use strict";__p&&__p();var k=j.selected;if(k.uid==null)this.recordStat("selected_id","SELECT_NULL");else this.recordStat("selected_id",k.uid);this.recordStat("selected_type",k.type);this.recordStat("selected_score",k.score);this.recordStat("selected_original_id",k.original_id);this.recordStat("place_id",k.place_id);this.recordStat("client_time",k.client_time);this.recordStat("selected_position",j.index);this.recordStat("selected_with_mouse",j.clicked?1:0);this.recordStat("selected_query",j.query);this._sessionEnd()};i.prototype.bindSessionStart=function(j,event,k){"use strict";if(k)for(var l=0;l<this._sessionStartEvents.length;++l){var m=this._sessionStartEvents[l];m.obj.unsubscribe(m.token)}this._sessionStartEvents.push({obj:j,token:j.subscribe(event,function(n,o){this._sessionStart()}.bind(this))})};i.prototype.bindSessionEnd=function(j,event,k){"use strict";if(k)for(var l=0;l<this._sessionEndEvents.length;++l){var m=this._sessionEndEvents[l];m.obj.unsubscribe(m.token)}this._sessionEndEvents.push({obj:j,token:j.subscribe(event,function(n,o){this._sessionEnd()}.bind(this))})};i.prototype.dataSubscribe=function(j,k){"use strict";var l=this.data,m=this.data.subscribe(j,k);this._dataSubscriptions.push(function(){l.unsubscribe(m)})};i.prototype.initEvents=function(){"use strict";__p&&__p();this._dataSubscriptions=this._dataSubscriptions||[];this._dataSubscriptions.forEach(function(j){j()});this._dataSubscriptions=[];this.bindSessionStart(this.core,"focus",false);this.bindSessionEnd(this.core,"blur",false);this.view.subscribe("select",function(j,k){this.recordSelect(k)}.bind(this));this.bindSessionEnd(this.view,"select",false);this.view.subscribe("render",function(j,k){this.results=k}.bind(this));this.dataSubscribe("beforeQuery",function(j,k){this._logEvent("user_typed",{query:k.value});if(!k.value)return;this.query=k.value;this.queriesHistory.add(this.query);if(this.lastNotBackspacedQuery.indexOf(this.query)!==0)this.lastNotBackspacedQuery=this.query;this.recordCountStat("num_queries")}.bind(this));this.dataSubscribe("beforeFetch",function(j,k){if(k.fetch_context.bootstrap)this.bootstrapBegin=Date.now();else k.fetch_context.queryBegin=Date.now();this._logEvent("async_query_started",{query:k.fetch_context.value,request_id:k.fetch_context.request_id})}.bind(this));this.dataSubscribe("fetchComplete",function(j,k){__p&&__p();this._logEvent("async_query_completed",{query:k.fetch_context.value,request_id:k.fetch_context.request_id});if(k.fetch_context.bootstrap){this.recordAvgStat("bootstrap_latency",Date.now()-this.bootstrapBegin);var l={};k.response.payload.entries.forEach(function(m){if(!l[m.type])l[m.type]=1;else l[m.type]++});this.recordStat("bootstrap_response_types",l);this.bootstrapped=true}else{if("filtered_count"in k.response.payload)this.recordStat("filtered_count",k.response.payload.filtered_count);this.recordAvgStat("avg_query_latency",Date.now()-k.fetch_context.queryBegin)}}.bind(this));this.dataSubscribe("respond",function(j,k){this._logEvent("respond",{query:k.value,num_results:k.results.length});var l=this.data.tokenizeBackend(k.value||"").flatValue,m=this.data.findBestPreviousQuery(l,this.data.getQueryIDs())||"",n=this.data.getQueryIDs()[m];this.normalized_backend_query=m;this.request_id=n;this.request_ids.push(n)}.bind(this));this.dataSubscribe("dirty",function(j,k){this.bootstrapped=false}.bind(this))};i.prototype._sessionStart=function(){"use strict";if(this.sessionActive)return;this.sessionActive=true};i.prototype._sessionEnd=function(){"use strict";if(!this.sessionActive)return;this.sessionActive=false;this.submit();this._reset()};i.prototype.recordStat=function(j,k){"use strict";this.stats[j]=k};i.prototype.recordCountStat=function(j){"use strict";var k=this.stats[j];this.stats[j]=k?k+1:1};i.prototype.recordAvgStat=function(j,k){"use strict";if(this.avgStats[j]){this.avgStats[j][0]+=k;++this.avgStats[j][1]}else this.avgStats[j]=[k,1]};i.prototype.hasStats=function(){"use strict";return!!Object.keys(this.stats).length};i.prototype.submit=function(){"use strict";__p&&__p();if("log_all_sessions"in this.extraData||this.hasStats()){Object.assign(this.stats,this.extraData);if(this.results){var j=this.results.map(function(m,n){return m.uid});this.recordStat("candidate_results",JSON.stringify(j))}if(this.query)this.recordStat("query",this.query);if(this.lastNotBackspacedQuery)this.recordStat("last_not_backspaced_query",this.lastNotBackspacedQuery);this.recordStat("queries_history",JSON.stringify(this.queriesHistory.getQueries()));if(this.normalized_backend_query)this.recordStat("normalized_backend_query",this.normalized_backend_query);if(this.request_id)this.recordStat("request_id",this.request_id);if(this.request_ids.length)this.recordStat("request_ids",this.request_ids);if(this.sid)this.recordStat("sid",this.sid);if(this.bootstrapped)this.recordStat("bootstrapped",1);for(var k in this.avgStats){var l=this.avgStats[k];this.stats[k]=l[0]/l[1]}this.recordStat("log",JSON.stringify(this.log));new(c("AsyncRequest"))().setURI(this.endPoint).setMethod("POST").setData({stats:this.stats}).setErrorHandler(c("emptyFunction")).send();this._reset()}};i.register=function(j,k,l){"use strict";if(document.activeElement===j)k.init(l);else var m=c("Event").listen(j,"focus",function(){k.init(l);m.remove()})};Object.assign(i.prototype,{endPoint:"/ajax/typeahead/record_basic_metrics.php"});f.exports=i}),null);
__d("XBirthdayMessagePostController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/reminders/birthday/message/",{})}),null);