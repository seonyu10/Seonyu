if (self.CavalryLogger) { CavalryLogger.start_js(["ScvHN"]); }

__d("FundsAvailability",[],(function a(b,c,d,e,f,g){f.exports={NONE:0,FUNDS_AVAILABILITY_NA:65,FUNDS_AVAILABILITY_IMMEDIATE:73,FUNDS_AVAILABILITY_SAME_DAY:83,FUNDS_AVAILABILITY_NEXT_DAY:78,FUNDS_AVAILABILITY_FIVE_DAY:70,FUNDS_AVAILABILITY_UNKNOWN:85,FUNDS_AVAILABILITY_ONE_THREE_DAY:79,FUNDS_AVAILABILITY_CROSS_BORDER:66,FUNDS_AVAILABILITY_CROSS_BORDER_FAST_FUNDS:67,FUNDS_AVAILABILITY_DOMESTIC:68,FUNDS_AVAILABILITY_DOMESTIC_FAST_FUNDS:69}}),null);
__d("VideoBroadcastStatus",[],(function a(b,c,d,e,f,g){f.exports={PREVIEW:"PREVIEW",LIVE:"LIVE",LIVE_STOPPED:"LIVE_STOPPED",VOD_READY:"VOD_READY",SEAL_STARTED:"SEAL_STARTED",SCHEDULED_PREVIEW:"SCHEDULED_PREVIEW",SCHEDULED_LIVE:"SCHEDULED_LIVE",SCHEDULED_EXPIRED:"SCHEDULED_EXPIRED",SCHEDULED_CANCELED:"SCHEDULED_CANCELED",PRE_LIVE:"PRE_LIVE"}}),null);
__d("AjaxRequest",["ErrorUtils","Keys","PHPQuerySerializer","TimeSlice","URI","UserAgent_DEPRECATED","ZeroRewrites","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g){__p&&__p();function h(l,m,n){if(!(m instanceof c("URI")))m=new(c("URI"))(m);this.xhr=c("ZeroRewrites").getTransportBuilderForURI(m)();if(n&&l=="GET")m.setQueryData(n);else this._params=n;this.method=l;this.uri=m;this.xhr.open(l,m)}var i=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest();h.supportsCORS=function(){return i};h.ERROR="ar:error";h.TIMEOUT="ar:timeout";h.PROXY_ERROR="ar:proxy error";h.TRANSPORT_ERROR="ar:transport error";h.SERVER_ERROR="ar:http error";h.PARSE_ERROR="ar:parse error";h.SERVICE_UNAVAILABLE="ar:noservice";h._inflight=[];function j(){var l=h._inflight;h._inflight=[];l.forEach(function(m){m.abort()})}function k(l){l.onJSON=l.onError=l.onSuccess=null;clearTimeout(l._timer);if(l.xhr&&l.xhr.readyState<4){l.xhr.abort();l.xhr=null}h._inflight=h._inflight.filter(function(m){return m&&m!=l&&m.xhr&&m.xhr.readyState<4})}Object.assign(h.prototype,{timeout:6e4,streamMode:true,prelude:/^for \(;;\);/,status:null,_eol:-1,_call:function l(m){if(this[m])this[m](this)},_parseStatus:function l(){__p&&__p();var m;try{this.status=this.xhr.status;m=this.xhr.statusText}catch(n){if(this.xhr.readyState>=4){this.errorType=h.TRANSPORT_ERROR;this.errorText=n.message}return}if(this.status===0&&!/^(file|ftp)/.test(this.uri))this.errorType=h.TRANSPORT_ERROR;else if(this.status>=100&&this.status<200)this.errorType=h.PROXY_ERROR;else if(this.status>=200&&this.status<300)return;else if(this.status>=300&&this.status<400)this.errorType=h.PROXY_ERROR;else if(this.status>=400&&this.status<500)this.errorType=h.SERVER_ERROR;else if(this.status===503)this.errorType=h.SERVICE_UNAVAILABLE;else if(this.status>500&&this.status<600)this.errorType=h.PROXY_ERROR;else if(this.status==1223)return;else if(this.status>=12001&&this.status<=12156)this.errorType=h.TRANSPORT_ERROR;else{m="unrecognized status code: "+this.status;this.errorType=h.ERROR}if(!this.errorText)this.errorText=m},_parseResponse:function l(){__p&&__p();var m,n=this.xhr.readyState;try{m=this.xhr.responseText||""}catch(o){if(n>=4){this.errorType=h.ERROR;this.errorText="responseText not available - "+o.message}return}while(this.xhr){var p=this._eol+1,q=this.streamMode?m.indexOf("\n",p):m.length;if(q<0&&n==4)q=m.length;if(q<=this._eol)break;var r=m;if(this.streamMode)r=m.substr(p,q-p).replace(/^\s*|\s*$/g,"");if(p===0&&this.prelude)if(this.prelude.test(r))r=r.replace(this.prelude,"");this._eol=q;if(r){try{this.json=JSON.parse(r)}catch(o){var s=/(<body[\S\s]+?<\/body>)/i.test(m)&&RegExp.$1,t={message:o.message,"char":p,excerpt:(p===0&&s||r).substr(512)};this.errorType=h.PARSE_ERROR;this.errorText="parse error - "+JSON.stringify(t);return}c("ErrorUtils").applyWithGuard(this._call,this,["onJSON"])}}},_onReadyState:function l(m,n){__p&&__p();var o=this.xhr&&this.xhr.readyState||0;if(this.status==null&&o>=2)this._parseStatus();if(!this.errorType&&this.status!=null)if(o==3&&this.streamMode||o==4)m.call(this);if(this.errorType||o==4){this._time=Date.now()-this._sentAt;n.call(this,this._call,!this.errorType?"onSuccess":"onError");k(this)}},send:function l(m){__p&&__p();var n=c("TimeSlice").getGuardedContinuation("AjaxRequest xhr.onreadystatechange",true),o=c("TimeSlice").guard(this._parseResponse.bind(this),"AjaxRequest xhr.parseResponse",{propagationType:c("TimeSlice").PropagationType.EXECUTION});this.xhr.onreadystatechange=this._onReadyState.bind(this,o,n);var p=this.timeout;if(p)this._timer=c("setTimeoutAcrossTransitions")(function(){this.errorType=h.TIMEOUT;this.errorText="timeout";this._time=Date.now()-this._sentAt;this._call("onError");k(this)}.bind(this),p);h._inflight.push(this);if(this.method=="POST")this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this._sentAt=Date.now();this.xhr.send(m?c("PHPQuerySerializer").serialize(m):"")},abort:function l(){k(this)},toString:function l(){var m="[AjaxRequest readyState="+this.xhr.readyState;if(this.errorType)m+=" errorType="+this.errorType+" ("+this.errorText+")";return m+"]"},toJSON:function l(){var m={json:this.json,status:this.status,errorType:this.errorType,errorText:this.errorText,time:this._time};if(this.errorType)m.uri=this.uri;for(var n in m)if(m[n]==null)delete m[n];return m}});if(window.addEventListener&&c("UserAgent_DEPRECATED").firefox())window.addEventListener("keydown",function(event){if(event.keyCode===c("Keys").ESC)event.prevent()},false);if(window.attachEvent)window.attachEvent("onunload",j);f.exports=h}),null);
__d("ChannelSubdomain",["Event","JSLogger","Run","LogHistory","setTimeoutAcrossTransitions","WebStorage"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("LogHistory").getInstance("channel"),i=c("JSLogger").create("channel"),j="channel_sub:",k=7,l=100*1e3,m=null,n;function o(){var q=c("WebStorage").getLocalStorage();if(n){clearTimeout(n);n=null}if(q&&m!=null)q.removeItem(j+m);m=null}function p(q,r,s){__p&&__p();var t,u=(q-1)*k;if(s){if(n)clearTimeout(n);m=n=null}if(r==null)r=Math.floor(Math.random()*u);if(m==null){var v,w,x,y,z,A,B;(function(){__p&&__p();var C=c("WebStorage").getLocalStorage();if(C){v=[];for(w=0;w<C.length;w++){x=C.key(w);if(x.indexOf(j)===0){y=parseInt(x.substr(j.length),10);v[y]=parseInt(C.getItem(x),10)}}z=Date.now()-l;for(w=0;w<u;w++){A=(w+r)%u;if(!v[A]||v[A]<z){m=A;break}}if(m!=null){B=function D(){try{C.setItem(j+m,Date.now())}catch(E){h.warn("subdomain set failed",E.message)}n=c("setTimeoutAcrossTransitions")(B,l/2)};B()}else{h.warn("no channel subdomain",v);i.error("subdomain_overflow")}if(typeof window.onpageshow!="undefined")c("Event").listen(window,"pagehide",o);else c("Run").onUnload(o)}else m=r})()}return m==null?null:m%k}f.exports={allocate:p,clear:o}}),null);
__d("ChatproxyClientErrorsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$ChatproxyClientErrorsTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$ChatproxyClientErrorsTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$ChatproxyClientErrorsTypedLogger1={};return this};h.prototype.updateData=function(j){this.$ChatproxyClientErrorsTypedLogger1=babelHelpers["extends"]({},this.$ChatproxyClientErrorsTypedLogger1,j);return this};h.prototype.setErrorMessage=function(j){this.$ChatproxyClientErrorsTypedLogger1.error_message=j;return this};h.prototype.setErrorReason=function(j){this.$ChatproxyClientErrorsTypedLogger1.error_reason=j;return this};h.prototype.setStatusCode=function(j){this.$ChatproxyClientErrorsTypedLogger1.status_code=j;return this};h.prototype.setTopicPrefixes=function(j){this.$ChatproxyClientErrorsTypedLogger1.topic_prefixes=c("GeneratedLoggerUtils").serializeVector(j);return this};h.prototype.setURL=function(j){this.$ChatproxyClientErrorsTypedLogger1.url=j;return this};var i={error_message:true,error_reason:true,status_code:true,topic_prefixes:true,url:true};f.exports=h}),null);
__d("DocRPC",["ErrorUtils"],(function a(b,c,d,e,f,g){__p&&__p();var h={_apis:{},_dispatch:function i(j){__p&&__p();var k;try{j=JSON.parse(j)}catch(l){throw new Error('DocRPC unparsable dispatch: "'+j+'"')}if(Object.prototype.hasOwnProperty.call(h._apis,j.api)){var m=h._apis[j.api];if(m[j.method])k=c("ErrorUtils").applyWithGuard(m[j.method],m,j.args)}if(k===undefined)k=null;return JSON.stringify(k)},publish:function i(j,k){h._apis[k]=j},proxy:function i(j,k,l){__p&&__p();var i={};l.forEach(function(m){__p&&__p();i[m]=function(){__p&&__p();var n={api:k,method:m,args:Array.prototype.slice.call(arguments)},o;try{if(j.closed)throw new Error("DocRPC window closed");o=j.DocRPC._dispatch(JSON.stringify(n))}catch(p){c("ErrorUtils").reportError(p);return}if(typeof o=="string")try{o=JSON.parse(o)}catch(p){throw new Error("DocRPC "+k+"."+m+' unparsable return: "'+o+'"')}return o}});return i}};f.exports=b.DocRPC=h}),null);
__d("ChannelTransport",["AjaxRequest","ChannelConstants","DocRPC","LogHistory","TimeSlice","URI","bind","setTimeoutAcrossTransitions","BanzaiODS","ChatproxyClientErrorsTypedLogger"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("LogHistory").getInstance("channel");function i(v){__p&&__p();var w=new(c("ChatproxyClientErrorsTypedLogger"))();w.setStatusCode(v.status);if(v.xhr!=null){var x=v.xhr.getResponseHeader("x-fb-chat-failure-reason");if(x)w.setErrorReason(x)}w.setErrorMessage(v.errorType);if(v.uri!==undefined)w.setURL(v.uri.getPath());w.log()}function j(){return(1048576*Math.random()|0).toString(36)}function k(v){return v!==null&&v!==undefined&&!isNaN(v)&&isFinite(v)&&0<=v&&v<=6}function l(v,w){var x="";if(k(v.subdomain))x=v.subdomain+"-";var y=v.host;y=y===null||y===undefined?"edge-chat":v.host;var z=new(c("URI"))(w).setDomain(x+y+"."+v.domain).setPort(v.port).setSecure(new(c("URI"))(window.location.href).isSecure());return z}function m(v){__p&&__p();var w={partition:v.partition,cb:j(),failure:v.pingFailuresOnSubdomain};if(v.sticky_token)w.sticky_token=v.sticky_token;if(v.sticky_pool)w.sticky_pool=v.sticky_pool;var x=l(v,"/p").setQueryData(w);h.log("start_p",{uri:x.toString()});var y=new(c("AjaxRequest"))("GET",x);if(c("AjaxRequest").supportsCORS())y.xhr.withCredentials=true;var z=function z(A){h.log("finish_p",{xhr:A.toJSON?A.toJSON():A,subdomain:v.subdomain,fullHost:v.fullHost})};y.onError=function(A){__p&&__p();c("BanzaiODS").bumpEntityKey("ChannelTransport","sendP.error");i(y);z(A);if(v.subdomain===null)return;if(k(v.subdomain)){v.pingFailuresOnSubdomain++;v.subdomain++;if(v.subdomain>6)v.subdomain=0}};y.timeout=v.P_TIMEOUT;y.onSuccess=function(A){c("BanzaiODS").bumpEntityKey("ChannelTransport","sendP.success");z(A)};y.send()}function n(v,w,x){__p&&__p();var y=new Image(),z=0,A=function A(D){y.abort();return D?w():x()};y.onload=c("TimeSlice").guard(function(){h.log("ping_ok",{duration:Date.now()-z});c("BanzaiODS").bumpEntityKey("ChannelTransport","sendPing.success");A(true)},"ChannelTransport image.onload");y.onerror=c("TimeSlice").guard(function(){m(v);c("BanzaiODS").bumpEntityKey("ChannelTransport","sendPing.error");i(y);A(false)},"ChannelTransport image.onerror");var B=c("setTimeoutAcrossTransitions")(y.onerror,1e4);y.abort=function(){if(B){clearTimeout(B);B=null}y.onload=y.onerror=null};var C={partition:v.partition,cb:j()};if(v.sticky_token)C.sticky_token=v.sticky_token;if(v.sticky_pool)C.sticky_pool=v.sticky_pool;if(v.lastRequestErrorReason){C.reason=v.lastRequestErrorReason;v.lastRequestErrorReason=null}if(v.uid&&v.viewerUid){C.uid=v.uid;C.viewer_uid=v.viewerUid}z=Date.now();y.src=l(v,"/ping").setQueryData(C);return y}function o(v,w){__p&&__p();var x={channel:v.user_channel,partition:v.partition,clientid:v.sessionID,cb:j(),cap:0,uid:v.uid,viewer_uid:v.viewerUid};if(v.sticky_token)x.sticky_token=v.sticky_token;if(v.sticky_pool)x.sticky_pool=v.sticky_pool;if(v.profile)x.profile=v.profile;if(v.capabilities)x.cap=v.capabilities;x.id=w;var y=l(v,"/add_bud").setQueryData(x),z=new(c("AjaxRequest"))("GET",y);if(c("AjaxRequest").supportsCORS())z.xhr.withCredentials=true;z.onError=function(A){c("BanzaiODS").bumpEntityKey("ChannelTransport","sendAdditionalBuddy.error");h.warn("add_buddy_error");i(z)};z.onSuccess=function(A){c("BanzaiODS").bumpEntityKey("ChannelTransport","sendAdditionalBuddy.success");h.log("add_buddy_ok")};z.timeout=v.P_TIMEOUT;z.send()}function p(v){__p&&__p();var w={channel:v.user_channel,partition:v.partition,clientid:v.sessionID,cb:j(),cap:0,uid:v.uid,viewer_uid:v.viewerUid};if(v.sticky_token)w.sticky_token=v.sticky_token;if(v.sticky_pool)w.sticky_pool=v.sticky_pool;if(v.is_offline||v.shouldSuppressPresence)w.state="offline";else w.state="active";if(w.state===v.lastPresenceState)return;v.lastPresenceState=w.state;if(v.profile)w.profile=v.profile;if(v.capabilities)w.cap=v.capabilities;var x=l(v,"/active_ping").setQueryData(w),y=new(c("AjaxRequest"))("GET",x);if(c("AjaxRequest").supportsCORS())y.xhr.withCredentials=true;y.onError=function(z){c("BanzaiODS").bumpEntityKey("ChannelTransport","sendActivePing.error");h.warn("active_ping_error");i(y)};y.onSuccess=function(z){c("BanzaiODS").bumpEntityKey("ChannelTransport","sendActivePing.success");h.log("active_ping_ok")};y.timeout=v.P_TIMEOUT;y.send()}function q(v,w,x,y){__p&&__p();var z=new Date(),A=-1;if(v.userActive>0){A=(z-v.userActive)/1e3|0;if(A<0)h.warn("idle_regression",{idleTime:A,now:z.getTime(),userActive:v.userActive})}var B={channel:v.user_channel,seq:v.seq,partition:v.partition,clientid:v.sessionID,cb:j(),idle:A,qp:"y",cap:0};if(v.state.aiq)B.aiq=v.state.aiq;if(v.ready)if(v.seqTurSentAt==-1||v.seqTurSentAt==v.seq){B.tur=v.timeUntilReady;B.qpmade=v.queueMade;v.seqTurSentAt=v.seq}B.pws=v.pws;if(v.sequenceId>0)B.isq=v.sequenceId;B.msgs_recv=v.estimatedReceived;if(v.uid&&v.viewerUid){B.uid=v.uid;B.viewer_uid=v.viewerUid}if(v.sticky_token)B.sticky_token=v.sticky_token;else{B.request_batch=1;if(v.msgr_region)B.msgr_region=v.msgr_region}if(v.sticky_pool)B.sticky_pool=v.sticky_pool;if("trace_id"in v)B.traceid=v.trace_id;if(v.is_offline||v.shouldSuppressPresence)B.state="offline";else if(v.userActive>0&&A<60)B.state="active";v.lastPresenceState=B.state;if(v.streamingCapable){B.mode="stream";B.format="json"}if(v.profile)B.profile=v.profile;if(v.capabilities)B.cap=v.capabilities;var C=l(v,"/pull").setQueryData(B),D="GET",E=new(c("AjaxRequest"))(D,C);if(c("AjaxRequest").supportsCORS())E.xhr.withCredentials=true;E.timeout=v.streamingCapable?v.STREAMING_TIMEOUT:v.LONGPOLL_TIMEOUT;E.onJSON=function(E){c("BanzaiODS").bumpEntityKey("ChannelTransport","sendPull.json");w(E)};E.onSuccess=function(F){c("BanzaiODS").bumpEntityKey("ChannelTransport","sendPull.success");x(F)};E.onError=function(){var F=this.status==12002&&this._time>=v.MIN_12002_TIMEOUT||this.status==504&&this._time>=v.MIN_504_TIMEOUT,G=F?x:y;if(F)c("BanzaiODS").bumpEntityKey("ChannelTransport","sendPull.success");else{c("BanzaiODS").bumpEntityKey("ChannelTransport","sendPull.error");i(E)}return G&&G.apply(this,arguments)};E.send();v.inStreaming=v.streamingCapable;return E}function r(v){this.manager=v;this.init&&this.init()}function s(v){r.apply(this,arguments)}Object.assign(s.prototype,{logName:"CORS",enterState:function v(w,x){__p&&__p();if(this._request){this._request.abort();this._request=null}if(w=="init")c("setTimeoutAcrossTransitions")(c("bind")(this.manager,"exitState",{status:c("ChannelConstants").OK,stateId:x.stateId}),0);if(!/pull|ping/.test(w))return;var y=this.manager;if(w=="ping")this._request=n(x,c("bind")(y,"exitState",{status:c("ChannelConstants").OK,stateId:x.stateId}),c("bind")(y,"exitState",{status:c("ChannelConstants").ERROR,stateId:x.stateId}));else if(w=="pull")this._request=q(x,c("bind")(y,"_processTransportData",x.stateId),c("bind")(y,"exitState",{status:c("ChannelConstants").OK,stateId:x.stateId}),c("bind")(y,"exitState",{status:c("ChannelConstants").ERROR,stateId:x.stateId}))}});function t(v){h.log("iframe_init_constructor");r.apply(this,arguments);this._iframe=document.createElement("iframe");this._iframe.style.display="none";document.body.appendChild(this._iframe);c("DocRPC").publish(this,"outerTransport")}Object.assign(t.prototype,{logName:"iframe",_initIframe:function v(w){__p&&__p();h.log("iframe_init_start");window.onchanneliframeready=function(){h.log("iframe_resources");return w.resources};window.onchanneliframeloaded=function(){h.log("iframe_loaded")};if(w){this._iframeURI=l(w,w.path);if(w.resources){var x=this._iframeURI.getDomain();w.resources=w.resources.map(function(z){var A=new(c("URI"))(z);if(A.getPath().startsWith("/intern/rsrc.php")&&A.getQueryData().origin!==undefined)return A.addQueryData("origin",x).toString();return z})}}else this._iframeURI="about:blank";this._iframeProxy=null;try{this._iframe.contentWindow.location.replace(this._iframeURI);h.log("iframe_uri_set")}catch(y){h.error("iframe_uri_set_error",y);this.exitState({status:c("ChannelConstants").ERROR,stateId:w.stateId},y+"")}},enterState:function v(w,x){__p&&__p();if(w=="init")this._initIframe(x);else if(/idle|ping|pull/.test(w)){if(this._iframeProxy)this._iframeProxy.enterState.apply(this._iframeProxy,arguments);else if(w!="idle")this.exitState({status:c("ChannelConstants").ERROR,stateId:x.stateId},"iframe not yet loaded")}else if(w=="shutdown")this._initIframe()},_processTransportData:function v(){this.manager._processTransportData.apply(this.manager,arguments)},exitState:function v(w){if(this.manager.state=="init"&&w.status==c("ChannelConstants").OK)this._iframeProxy=c("DocRPC").proxy(this._iframe.contentWindow,"innerTransport",["enterState"],(this._iframeURI+"").replace(/iframe.*/,""));if(/ping|pull/.test(this.manager.state)&&!this._iframeProxy)return;this.manager.exitState.apply(this.manager,arguments)}});function u(){this.init=this.init.bind(this);r.apply(this,arguments)}Object.assign(u.prototype,{logName:"iframe(inner)",init:function v(){c("DocRPC").publish(this,"innerTransport");try{var w=c("DocRPC").proxy(window.parent,"outerTransport",["_processTransportData","exitState"],top.DocRPC.origin);Object.assign(this,w);this.exitState({status:c("ChannelConstants").OK,stateId:1e6})}catch(x){h.error("iframe_inner_init_error",x)}},enterState:function v(w,x){if(this._request){this._request.abort();this._request=null}if(w=="ping")this._request=n(x,c("bind")(this,"exitState",{status:c("ChannelConstants").OK,stateId:x.stateId}),c("bind")(this,"exitState",{status:c("ChannelConstants").ERROR,stateId:x.stateId}));else if(w=="pull")this._request=q(x,c("bind")(this,"_processTransportData",x.stateId),c("bind")(this,"exitState",{status:c("ChannelConstants").OK,stateId:x.stateId}),c("bind")(this,"exitState",{status:c("ChannelConstants").ERROR,stateId:x.stateId}))}});f.exports={isSubdomain:k,getURI:l,Transport:r,CORSTransport:s,IframeTransport:t,IframeInnerTransport:u,sendActivePing:p,sendAdditionalBuddyRequest:o}}),null);
__d("ChannelTransportDataLogger",["Arbiter","JSLogger","MercuryLoggingHelper"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=[],i=10,j=function j(l){__p&&__p();return l.map(function(m){var n=m;if(m.message||m.delta&&m.delta.body){n=babelHelpers["extends"]({},m);if(m.message)n.message=c("MercuryLoggingHelper").obfuscateMessage(m.message);if(m.delta&&m.delta.body)n.delta=c("MercuryLoggingHelper").obfuscateMessage(m.delta)}return n})},k={log:function l(m){var n={t:m.t,seq:m.seq};if(m.ms)n.ms=j(m.ms);h.push(n);if(h.length>i)h.shift()}};c("Arbiter").subscribe(c("JSLogger").DUMP_EVENT,function(l,m){m.channelTransportLog=h});f.exports=k}),null);
__d("ChatProxyConnectionState",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.auxiliaryIrisQueues={};this.aiq=null}h.prototype.subscribeIrisQueue=function(i,j){this.auxiliaryIrisQueues[i]=j;this.updateCaches()};h.prototype.unsubscribeIrisQueue=function(i){delete this.auxiliaryIrisQueues[i];this.updateCaches()};h.prototype.updateCaches=function(){var i=[];for(var j in this.auxiliaryIrisQueues)if(Object.prototype.hasOwnProperty.call(this.auxiliaryIrisQueues,j)){i.push(j);i.push(this.auxiliaryIrisQueues[j])}if(i.length===0)this.aiq=null;else this.aiq=i.join(",")};f.exports=h}),null);
__d("FBAjaxRequest",["AjaxRequest","getAsyncParams"],(function a(b,c,d,e,f,g){__p&&__p();function h(i,j,k){__p&&__p();k=babelHelpers["extends"]({},c("getAsyncParams")(i),k);var l=new(c("AjaxRequest"))(i,j,k);l.streamMode=false;var m=l._call;l._call=function(n){if(n=="onJSON"&&this.json){if(this.json.error){this.errorType=c("AjaxRequest").SERVER_ERROR;this.errorText="AsyncResponse error: "+this.json.error}this.json=this.json.payload}m.apply(this,arguments)};l.ajaxReqSend=l.send;l.send=function(n){this.ajaxReqSend(babelHelpers["extends"]({},n,k))};return l}f.exports=h}),null);
__d("FantailLogger",["FantailConfig"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("FantailConfig").FantailLogQueue,i={debug:function j(k,l){var m;for(var n=arguments.length,o=Array(n>2?n-2:0),p=2;p<n;p++)o[p-2]=arguments[p];h&&(m=h.get(k)).debug.apply(m,[l].concat(o))},info:function j(k,l){var m;for(var n=arguments.length,o=Array(n>2?n-2:0),p=2;p<n;p++)o[p-2]=arguments[p];h&&(m=h.get(k)).info.apply(m,[l].concat(o))},warn:function j(k,l){var m;for(var n=arguments.length,o=Array(n>2?n-2:0),p=2;p<n;p++)o[p-2]=arguments[p];h&&(m=h.get(k)).warn.apply(m,[l].concat(o))},error:function j(k,l){var m;for(var n=arguments.length,o=Array(n>2?n-2:0),p=2;p<n;p++)o[p-2]=arguments[p];h&&(m=h.get(k)).error.apply(m,[l].concat(o))}};f.exports=i}),null);
__d("MovingStat",[],(function a(b,c,d,e,f,g){__p&&__p();function h(i){__p&&__p();i=i||6e4;var j={t:new Date(),count:0,v:0},k=j,l=0,m=0;function n(){var o=new Date()-i;while(k&&k.next&&k.t<o){l-=k.v;m-=k.count;k=k.next}}this.add=function(o){__p&&__p();l+=o;m++;var p=new Date();if(p-j.t<1e3){j.v+=o;j.count++}else{j.next={t:p,v:o,count:1};j=j.next;n()}};this.tally=function(o){o=o||1e3;n();return{sum:l,count:m,timeAverage:l*o/i}}}f.exports=h}),null);
__d("RTISession",["invariant","URI","AjaxRequest","ErrorUtils","ChatproxyClientErrorsTypedLogger","BanzaiODS","Set"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();function i(j,k,l,m,n,o,p,q,r,s){__p&&__p();j||h(0);n||h(0);o||h(0);this.domain=j;this.topLevelDomain=k;this.port=l;this.edgePoolName=m;this.stickyToken=n;this.loggedInId=o;this.accountId=p;this.clientProfile=q||"desktop";this.clientId=r;this.capabilities=s}i.prototype.issueRequest=function(j,k,l,m,n){__p&&__p();j||h(0);k||h(0);m||h(0);var o=this.domain+"."+this.topLevelDomain,p=(1048576*Math.random()|0).toString(36),q={cb:p,sticky_token:this.stickyToken,uid:this.loggedInId,viewer_uid:this.accountId,sticky_pool:this.edgePoolName,profile:this.clientProfile,clientid:this.clientId,cap:this.capabilities};for(var r in q)!k[r]||h(0);Object.assign(q,k);var s=new(c("URI"))(j).setDomain(o).setPort(this.port).setSecure(new(c("URI"))(window.location.href).isSecure()).setQueryData(q),t=l?"POST":"GET",u=new(c("AjaxRequest"))(t,s);u.timeout=n?n*1e3:3e4;if(u.xhr)u.xhr.withCredentials=true;var v={};u.onSuccess=function(){c("BanzaiODS").bumpEntityKey("RTISession","request.success")};u.onJSON=function(){v.data=u.json;v.error=null;c("ErrorUtils").applyWithGuard(m,this,[v])}.bind(this);u.onError=function(){__p&&__p();var w=new(c("Set"))();if(l!==undefined&&l.subscriptions!==undefined)for(var x=0;x<l.subscriptions.length;x++){var y=l.subscriptions[x].topic.split("/");y.pop();w.add(y.join("/"))}v.data=null;v.error=u.errorType||"error";c("BanzaiODS").bumpEntityKey("RTISession","request.error");this.logRequestFailure(u,w);c("ErrorUtils").applyWithGuard(m,this,[v])}.bind(this);u.send(JSON.stringify(l))};i.prototype.logRequestFailure=function(j,k){__p&&__p();var l=new(c("ChatproxyClientErrorsTypedLogger"))();l.setStatusCode(j.status);if(j.xhr!=null){var m=j.xhr.getResponseHeader("x-fb-chat-failure-reason");if(m)l.setErrorReason(m)}l.setErrorMessage(j.errorType);l.setTopicPrefixes(k);l.setURL(j.uri.getPath());l.log()};f.exports=i}),null);
__d("ChannelManager",["errorCode","Promise","AjaxRequest","Arbiter","AsyncRequest","BanzaiODS","ChannelClientID","ChannelConstants","ChannelInitialData","ChannelSubdomain","ChannelTransport","ChannelTransportDataLogger","ChatVisibility","ChatReliabilityInstrumentation","DTSG","Env","FantailLogger","FBAjaxRequest","FBRTCSupport","ISB","JSLogger","LogHistory","MovingStat","PresenceCookieManager","PresenceState","PresenceUtil","Random","RTISession","SystemEvents","URI","UserActivity","ChatProxyConnectionState","emptyFunction","requestAnimationFrameAcrossTransitions","setIntervalAcrossTransitions","setTimeoutAcrossTransitions","clearTimeout"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j=c("JSLogger").create("channel"),k=c("LogHistory").getInstance("channel_manager"),l=null,m=c("emptyFunction"),n=new(c("Promise"))(function(z,A){m=z});function o(z){l=z}var p={idle:{ok:"init!"},init:{ok:"pull!",error:"reconnect",sys_online:"init",sys_timetravel:"init"},pull:{ok:"pull!",error:"ping",error_missing:"pull",error_msg_type:"pull",refresh_0:"reconnect",refresh_110:"reconnect",refresh_111:"reconnect",refresh_112:"pull",refresh_113:"pull",refresh_117:"reconnect"},ping:{ok:"pull!",error:"ping",error_stale:"reconnect!"},reconnect:{ok:"init!",error:"reconnect",sys_online:"reconnect",sys_timetravel:"reconnect"},shutdown:{},_all:{error_max:"shutdown!",error_shutdown:"shutdown!",sys_owner:"reconnect",sys_nonowner:"idle!",sys_online:"ping",sys_offline:"idle!",sys_timetravel:"ping"}},q={state:new(c("ChatProxyConnectionState"))(),userActive:Date.now(),created:Date.now(),ready:false,seqTurSentAt:-1,queueMade:"",sequenceId:0,lastPresenceState:null,lastRequestErrorReason:null,seq:0,pingFailuresOnSubdomain:0,pws:"fresh",estimatedReceived:0,sessionID:c("ChannelClientID").getID(),capabilities:c("FBRTCSupport").getCapabilities(),streamingCapable:false,inStreaming:false,shouldSuppressPresence:c("PresenceState").shouldSuppress(),LONGPOLL_TIMEOUT:6e4,STREAMING_TIMEOUT:6e4,P_TIMEOUT:3e4,IFRAME_LOAD_TIMEOUT:3e4,MIN_RETRY_INTERVAL:5e3,MAX_RETRY_INTERVAL:32e4,MIN_12002_TIMEOUT:9e3,MIN_504_TIMEOUT:2e4,STALL_THRESHOLD:18e4,JUMPSTART_THRESHOLD:9e4,MIN_INIT_PROBE_DELAY:3e3,INIT_PROBE_DELAY_RANDOMIZE_RANGE:12e3,CHANNEL_PROXY_REPORTING_MIN_INTERVAL:1e4,PROBE_DELAY:6e4,PROBE_HEARTBEATS_INTERVAL_LOW:1e3,PROBE_HEARTBEATS_INTERVAL_HIGH:5e3,STREAMING_EXIT_STATE_ON_CONTINUE:false},r=1,s={},t=0;function u(){return c("AsyncRequest").lastSuccessTime?Math.round((Date.now()-c("AsyncRequest").lastSuccessTime)/1e3):-1}function v(){var z={};if(i.getConfig("host"))z[i.getConfig("user_channel")]=i.getConfig("seq",0);return z}function w(){__p&&__p();var z=Date.now(),A=Date.now(),B={total:0},C="idle",D=false;c("SystemEvents").subscribe([c("SystemEvents").USER,c("SystemEvents").ONLINE,c("SystemEvents").TIME_TRAVEL],function(G,H){__p&&__p();x(true);A=null;i.lastPullTime=Date.now();var I;switch(G){case c("SystemEvents").USER:I=c("SystemEvents").isPageOwner()?c("ChannelConstants").SYS_OWNER:c("ChannelConstants").SYS_NONOWNER;break;case c("SystemEvents").ONLINE:I=H?c("ChannelConstants").SYS_ONLINE:c("ChannelConstants").SYS_OFFLINE;break;case c("SystemEvents").TIME_TRAVEL:if(q.skipTimeTravel)return;if(0<H){c("FantailLogger").warn(c("ChannelConstants").FANTAIL_SERVICE,"skipping time travel failure. %s",H);return}I=c("ChannelConstants").SYS_TIMETRAVEL;break}i.exitState({status:I,stateId:r})});var E=function E(G,H){__p&&__p();var I=Date.now(),J=null;if(H){z=I;J=H.nextState||H.state}else J=C;c("SystemEvents").checkTimeTravel();if(A){var K=Math.round((I-A)/1e3);if(K>0){B[C]=(B[C]||0)+K;B.total+=K}}C=J;A=I;if(!G){B.lastSuccessTime=u();B.online=c("SystemEvents").isOnline();k.log("rollup",JSON.stringify(B))}};c("Arbiter").subscribe(c("ChannelConstants").ON_ENTER_STATE,E);c("setIntervalAcrossTransitions")(E,6e4);c("Arbiter").subscribe(c("JSLogger").DUMP_EVENT,function(G,H){H.channelRollup=B});var F=function F(){__p&&__p();if(i.isShutdown()||i.shouldIdle())return;c("SystemEvents").checkTimeTravel();var G=Date.now()-(i.lastPullTime||c("Env").start);if(!D&&G>q.STALL_THRESHOLD){var H=u();k.error("stall",JSON.stringify({lastSuccessTime:H,rollupState:C}));c("ChatReliabilityInstrumentation").logCHANNEL_STALLED(G.toString());D=true}var I=Date.now()-z;if(i.state=="pull"&&I>q.JUMPSTART_THRESHOLD){z=null;k.warn("jumpstart",JSON.stringify({state:i.state,dormant:I}));c("Arbiter").inform(c("ChannelConstants").JUMPSTART,I);i.enterState("init")}};c("setIntervalAcrossTransitions")(F,5e3)}function x(z){if(z){t=0;s={}}else t++}function y(z,A){var B=!c("AjaxRequest").supportsCORS(),C=c("ChannelTransport").isSubdomain(q.subdomain);if(!C||B)q.fullHost=q.host;else q.fullHost=q.subdomain+"-"+q.host;c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"received lb info: %s at seq: %s{%s} with ".concat("sticky: %s/%s, subdomain: %s, fullHost: %s, state: %s,").concat(" source: %s, args: %s"),q.sessionID,q.seq,q.sequenceId,q.sticky_token,q.sticky_pool,q.subdomain,q.fullHost,i.state,z,A)}i={state:"idle",nextState:null,proxyDown:false,lastPullTime:Date.now(),lastReportOnMisguidedMsgTime:Date.now(),heartbeats:[],setTestCallback:o,backoff:false,sessionRegistered:false,init:function z(A,B){__p&&__p();c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"initializing sessionid:%s at iris-seq:%s",q.sessionID,q.sequenceId);this.init=c("emptyFunction");c("Arbiter").subscribe(c("ChannelConstants").GET_RTI_SESSION_REQUEST,function(event,G){this.informCurrentSession()}.bind(this));c("requestAnimationFrameAcrossTransitions")(function(){__p&&__p();c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"using session id: %s at seq: %s {%s} with sticky: %s/%s",q.sessionID,q.seq,q.sequenceId,q.sticky_token,q.sticky_pool);c("UserActivity").subscribe(function(){var G=c("ChannelTransport").getURI(q,"/U");c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"user activity sessionid: %s at seq: %s/{%s} with sticky: %s/%s state: %s uri: %s",q.sessionID,q.seq,q.sequenceId,q.sticky_token,q.sticky_pool,i.state,G);if(i.state=="pull"){q.userActive=Date.now();c("ChannelTransport").sendActivePing(q)}});c("Arbiter").subscribe(c("ChannelConstants").ENTITY_PRESENCE_ACTIVE_PING,function(G){var H=c("ChannelTransport").getURI(q,"/U");c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"entity presence activity sessionid: %s at seq: %s/{%s} with sticky: %s/%s state: %s uri: %s",q.sessionID,q.seq,q.sequenceId,q.sticky_token,q.sticky_pool,i.state,H);if(i.state=="pull")q.userActive=Date.now()})});c("PresenceCookieManager").register("ch",v);var C=this.getConfig("max_conn",2);q.subdomain=c("ChannelSubdomain").allocate(C);if(!c("ChannelTransport").isSubdomain(q.subdomain)){c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"invalid subdomain from ChannelSubdomain: %s",q.subdomain);q.subdomain=null}this._transportRate=new(c("MovingStat"))(3e4);var D=c("AjaxRequest").supportsCORS()?"CORSTransport":"IframeTransport";c("BanzaiODS").bumpEntityKey("ChannelManager","transport_chosen."+D);this.transport=new(c("ChannelTransport")[D])(this);m(this.transport);if(A)this.enterState(A,B);c("requestAnimationFrameAcrossTransitions")(function(){c("Arbiter").subscribe(c("JSLogger").DUMP_EVENT,function(event,G){if(this._transportRate){G.transportRate=this._transportRate.tally();G.transportType=D;G.transportVersion=2}}.bind(this));w()}.bind(this));if(i.getConfig("fullHost")&&c("AjaxRequest").supportsCORS()){if(i.getConfig("tryStreaming")){var E=q.MIN_INIT_PROBE_DELAY+c("Random").random()*q.INIT_PROBE_DELAY_RANDOMIZE_RANGE;c("setTimeoutAcrossTransitions")(this._probeTest,E)}if(i.getConfig("trySSEStreaming")){var F=q.MIN_INIT_PROBE_DELAY+c("Random").random()*q.INIT_PROBE_DELAY_RANDOMIZE_RANGE;c("setTimeoutAcrossTransitions")(this._sseProbeTest,F)}}},configure:function z(){for(var A=arguments.length,B=Array(A),C=0;C<A;C++)B[C]=arguments[C];k.log("configure",JSON.stringify(B));B.forEach(function(D){return Object.assign(q,D)});y("reconnect",JSON.stringify(B));c("Arbiter").inform(c("ChannelConstants").ON_CONFIG,this)},getConfig:function z(A,B){return Object.prototype.hasOwnProperty.call(q,A)?q[A]:B},getCompleteConfig:function z(){return q},subscribeIrisQueue:function z(A,B){q.state.subscribeIrisQueue(A,B);this.exitState({status:c("ChannelConstants").OK,stateId:r})},unsubscribeIrisQueue:function z(A){q.state.unsubscribeIrisQueue(A)},informCurrentSession:function z(){var A=null;if(this.sessionRegistered&&q&&q.fullHost&&q.sticky_token&&q.uid)A=new(c("RTISession"))(q.fullHost,q.domain,q.port,q.sticky_pool,q.sticky_token,q.uid,q.viewerUid,q.profile,q.sessionID,q.capabilities);c("Arbiter").inform(c("ChannelConstants").RTI_SESSION,A)},isShutdown:function z(){return this.state=="shutdown"},shouldIdle:function z(){return!(c("SystemEvents").isPageOwner()&&c("SystemEvents").isOnline())},_sendIframeError:function z(A){var B=new(c("AsyncRequest"))().setURI("/ajax/presence/reconnect.php").setData({reason:A,fb_dtsg:c("DTSG").getToken()}).setOption("suppressErrorHandlerWarning",true).setOption("retries",1).setMethod("GET").setReadOnly(true).setAllowCrossPageTransition(true);B.specifiesWriteRequiredParams()&&B.send()},_getDelay:function z(){var A=Math.min(q.MIN_RETRY_INTERVAL*Math.pow(2,Math.max(0,t-1)),q.MAX_RETRY_INTERVAL);if(this.proxyDown&&"proxy_down_delay_millis"in q)A=q.proxy_down_delay_millis;this.proxyDown=false;return Math.floor(A*(1+Math.random()*.5))},resetDelay:function z(){x(true)},enterState:function z(){__p&&__p();if(this._inEnterState){k.warn("enterstate_recursion",JSON.stringify({state:this.state,args:arguments}));c("ChatReliabilityInstrumentation").logERROR("enterstate_recursion")}this._inEnterState=true;try{this._enterState.apply(this,arguments);this._inEnterState=false}catch(A){this._inEnterState=false;throw A}},_enterState:function z(A){__p&&__p();var B=this.backoff?this._getDelay():0;this.backoff=false;if(this.isShutdown()){c("FantailLogger").warn(c("ChannelConstants").FANTAIL_SERVICE,"not executing state due to shutdown mode: %s",A);return}if(A!="idle!"&&this.shouldIdle()){c("FantailLogger").warn(c("ChannelConstants").FANTAIL_SERVICE,"forced idleness");return}r++;q.stateId=r;c("clearTimeout")(this._deferredTransition);this._deferredTransition=null;if(!this.transport){n.done(function(H){return H.enterState("idle")});c("ChatReliabilityInstrumentation").logERROR("called enterState "+A+" before transport init")}else this.transport.enterState("idle");this.state="idle";this.nextState=null;if(/!$/.test(A)){if(this._transportRate){var C=this._transportRate.tally().timeAverage,D=i.getConfig("MAX_CHANNEL_STATES_PER_SEC",1);if(C>=D){if(!this._throttled){this._throttled=true;k.warn("throttled","{}");c("Arbiter").inform(c("ChannelConstants").THROTTLED,C)}j.bump("throttle");B=1e3/D}}}else if(!/#$/.test(A))B=this._getDelay();A=A.replace(/\W*$/,"");if(!p[A]){c("FantailLogger").error(c("ChannelConstants").FANTAIL_SERVICE,"invalid state: %s",A);throw new Error("invalid state:"+A)}var E=Array.from(arguments),F;if(B<=0){F={state:A};if(this._transportRate)this._transportRate.add(1);this.state=A;var G=this["_enter_"+this.state];if(G){E.shift();G.apply(this,E)}if(/init|idle|pull|ping/.test(this.state)){if(q.streamingCapable&&/pull/.test(this.state))this.heartbeats=[];q.is_offline=!c("ChatVisibility").isOnline();q.capabilities=c("FBRTCSupport").getCapabilities();c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"entering transport state: %s",this.state);if(!this.transport){n.done(function(H){return H.enterState(this.state,q)}.bind(this));c("ChatReliabilityInstrumentation").logERROR("called enterState "+A+" before transport init")}else this.transport.enterState(this.state,q);if(this.state=="ping"){F.url=c("ChannelTransport").getURI(q).toString();F.port=q.port||"undefined"}}}else{this.state="idle";this.nextState=A;F={state:this.state,delay:B,nextState:A};E[0]=A+"#";this._deferredTransition=c("setTimeoutAcrossTransitions")(function(){this._deferredTransition=null;this.enterState.apply(this,E)}.bind(this),B)}if(/pull/.test(A)){F.client_id=q.sessionID;F.streaming=q.inStreaming}c("Arbiter").inform(c("ChannelConstants").ON_ENTER_STATE,F)},exitState:function z(A,B){__p&&__p();var C=A.stateId,D=A.status;if(this.isShutdown()||C<r)return;var E=this.state,F=Array.from(arguments);F[0]=A.status;var G={state:E,status:D};if(/pull/.test(E)){G.client_id=q.sessionID;G.streaming=q.inStreaming}if(/ping/.test(E)&&D!=c("ChannelConstants").OK)G.url=c("ChannelTransport").getURI(q).toString();if(this.nextState)G.nextState=this.nextState;if(B&&B.errorType){q.lastRequestErrorReason=B.errorType;G.xhr=B.toJSON?B.toJSON():B;if(B.errorType==c("AjaxRequest").SERVICE_UNAVAILABLE){c("FantailLogger").error(c("ChannelConstants").FANTAIL_SERVICE,"got 5xx http status code, setting long delay");this.proxyDown=true}delete G.xhr.json}else if(D!=c("ChannelConstants").OK)q.lastRequestErrorReason=D;if(B&&B.json){if(B.json.t)G.t=B.json.t;if(B.json.reason)G.reason=B.json.reason;if(B.json.seq)G.seq=B.json.seq}c("Arbiter").inform(c("ChannelConstants").ON_EXIT_STATE,G);var H=this["_exit_"+E];if(H)D=H.apply(this,F)||D;if(D!=c("ChannelConstants").OK){x();s[E]=(s[E]||0)+1}var I=p[this.nextState||E][D]||p._all[D],J=I&&I.replace(/!*$/,"");if(!J){k.error("terminal_transition",JSON.stringify(G));this._shutdownHint=c("ChannelConstants").HINT_INVALID_STATE;I="shutdown!";c("FantailLogger").error(c("ChannelConstants").FANTAIL_SERVICE,"entering shutdown state")}this._lastState=E;this._lastStatus=D;this.enterState(I)},_processTransportData:function z(A,B){this._processTransportData0(A,B,B.json)},_processTransportData0:function z(A,B,C){__p&&__p();var D=C.t;if("s"in C){C.seq=C.s;delete C.s}if(C.u&&q.user&&C.u!=q.user){k.warn("misguided_msg",JSON.stringify({user:q.user,target:C.u}));this._reportProxyMisguidedMsg(C.u,q.user);return}c("ChannelTransportDataLogger").log(C);var E=q.seq;if("seq"in C){q.seq=C.seq;c("PresenceState").doSync()}switch(D){case"continue":if(q.inStreaming&&this.heartbeats.length<1){q.streamingCapable=false;k.log("switch_to_longpoll","{}");c("setTimeoutAcrossTransitions")(this._probeTest,q.PROBE_DELAY)}x(true);if(!q.inStreaming||q.STREAMING_EXIT_STATE_ON_CONTINUE)this.exitState({status:c("ChannelConstants").OK,stateId:A});break;case"refresh":case"refreshDelay":c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"got refresh with reason: %s",C.reason);this.exitState({status:"refresh_"+(C.reason||0),stateId:A},B);break;case"backoff":c("FantailLogger").warn(c("ChannelConstants").FANTAIL_SERVICE,"server told client to back off");x();this.backoff=true;break;case"lb":var F=C.lb_info;if(F){q.sticky_token=F.sticky;if("pool"in F)q.sticky_pool=F.pool;if("sd"in F){var G=F.subdomain;if(c("ChannelTransport").isSubdomain(G))q.subdomain=F.subdomain}if("vip"in F)q.host=F.vip;y("chatproxy",JSON.stringify(C))}else k.error("missing_lb_info","{}");break;case"test_streaming":c("setTimeoutAcrossTransitions")(this._probeTest,500);break;case"fullReload":c("PresenceCookieManager").clear();k.log("full_reload","{}");this.sessionRegistered=true;this.informCurrentSession();c("Arbiter").inform(c("ChannelConstants").ON_INVALID_HISTORY);x(true);c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"full reload incurred");var H=c("ChannelConstants").OK;this.exitState({status:H,stateId:A},B);if("ms"in C)this._processMessages(C,E);break;case"msg":x(true);this._processMessages(C,E);break;case"heartbeat":if(q.inStreaming){var I=Date.now();if(this.heartbeats.length>0)var J=I-this.heartbeats[this.heartbeats.length-1];k.log("heartbeat_interval",JSON.stringify({client_id:q.sessionID,interval:J}));this.heartbeats.push(I)}break;case"batched":var K=C.batches,L;for(L=0;L<K.length;L++)this._processTransportData0(A,B,K[L]);break;default:c("FantailLogger").error(c("ChannelConstants").FANTAIL_SERVICE,"got an unknown protocol message: %s",D);k.error("unknown_msg_type",JSON.stringify({type:D}));break}},_processMessages:function z(A,B){__p&&__p();var C,D,E,F;if("tr"in A)q.trace_id=A.tr;D=A.ms;E=q.seq-D.length;for(C=0;C<D.length;C++,E++){q.estimatedReceived++;if(E>=B){F=D[C];if(F.type){var G=c("ChannelConstants").getArbiterType(F.type);if(F.type==="messaging"){var H={type:"messaging",event:F.event};if(F.message){H.inbox_unread=F.unread_counts&&F.unread_counts.inbox;H.tid=F.message.tid;H.mid=F.message.mid;c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"got message with id: %s",F.message.mid)}}else if(F.type==="skywalker")G=c("ChannelConstants").SKYWALKER;else if(F.type==="qprimer"){F.first=!q.ready;if(F.first){q.ready=true;q.timeUntilReady=Date.now()-q.created;q.queueMade=F.made}G=c("ChannelConstants").CHANNEL_ESTABLISHED}else if(F.type==="pws")q.pws=F.pws;else if(F.type==="delta")q.sequenceId=F.iseq;try{c("Arbiter").inform(G,{obj:F})}catch(I){c("BanzaiODS").bumpEntityKey("ChannelManager","processMessages.error."+F.type);c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"message threw exception: %s %s",I,F)}}}else k.warn("seq_regression",JSON.stringify({last_seq:B,messages:D.length,seq:E}))}},_enter_init:function z(){if(s.init>=i.getConfig("MAX_INIT_FAILS",2))return c("setTimeoutAcrossTransitions")(function(){return this.exitState({status:c("ChannelConstants").ERROR_MAX,stateId:r})}.bind(this),0);this._initTimer=c("setTimeoutAcrossTransitions")(function(){return this.exitState({status:c("ChannelConstants").ERROR,stateId:r},"timeout")}.bind(this),q.IFRAME_LOAD_TIMEOUT)},_enter_reconnect:function z(A){__p&&__p();k.warn("enter_reconnect",A);c("FantailLogger").info(c("ChannelConstants").FANTAIL_SERVICE,"entered reconnect with reason: %s",A);var B=r;if(!c("PresenceUtil").hasUserCookie()){c("FantailLogger").warn(c("ChannelConstants").FANTAIL_SERVICE,"user has no cookie???");k.warn("no_user_cookie","{}");c("setTimeoutAcrossTransitions")(function(){this._shutdownHint=c("ChannelConstants").HINT_AUTH;this.exitState({status:c("ChannelConstants").ERROR_SHUTDOWN,stateId:B})}.bind(this),0);return}var C={reason:A,fb_dtsg:c("DTSG").getToken()};if(c("ISB").token)C.fb_isb=c("ISB").token;if(l)l(C);var D=new(c("FBAjaxRequest"))("GET","/ajax/presence/reconnect.php",C);D.onSuccess=function(){i.configure(D.json);c("PresenceCookieManager").store();this.exitState({status:c("ChannelConstants").OK,stateId:B})}.bind(this);D.onError=function(){__p&&__p();var E=D.json&&D.json.error;c("FantailLogger").error(c("ChannelConstants").FANTAIL_SERVICE,"reconnect error: %s",D.errorType);if(D.errorType==c("AjaxRequest").TRANSPORT_ERROR||D.errorType==c("AjaxRequest").PROXY_ERROR||D.errorType==c("AjaxRequest").SERVICE_UNAVAILABLE)this._shutdownHint=c("ChannelConstants").HINT_CONN;if(E&&E==1356007)this._shutdownHint=c("ChannelConstants").HINT_MAINT;else if(E==1357001||E==1357004||E==1348009)this._shutdownHint=c("ChannelConstants").HINT_AUTH;else this._shutdownHint=null;this.exitState({status:this._shutdownHint?c("ChannelConstants").ERROR_SHUTDOWN:c("ChannelConstants").ERROR,stateId:B},D)}.bind(this);D.send()},_enter_shutdown:function z(){c("Arbiter").inform(c("ChannelConstants").ON_SHUTDOWN,{reason:this._shutdownHint});if("shutdown_recovery_interval_seconds"in q&&q.shutdown_recovery_interval_seconds>0){var A=q.shutdown_recovery_interval_seconds*1e3;c("setTimeoutAcrossTransitions")(function(){c("Arbiter").inform(c("ChannelConstants").ATTEMPT_RECONNECT);this._shutdownHint=null;this.state="reconnect!";this.enterState("reconnect!")}.bind(this),A)}},_exit_init:function z(A){if(this._initTimer)this._initTimer=c("clearTimeout")(this._initTimer);if(A==c("ChannelConstants").ERROR_MAX)this._sendIframeError(c("ChannelConstants").reason_IFrameLoadGiveUp)},_exit_pull:function z(A,B){var C=A==c("ChannelConstants").OK;if(C)this.lastPullTime=Date.now();else{var D="exit status: "+A;if(B&&B.errorType)D+=" ajax request error: "+B.errorType;c("FantailLogger").error(c("ChannelConstants").FANTAIL_SERVICE,"pull failed with status: %s",D)}},_exit_ping:function z(A){if(A==c("ChannelConstants").OK){var B=Date.now()-(this.lastPullTime||c("Env").start);if(B>q.STALL_THRESHOLD){c("FantailLogger").error(c("ChannelConstants").FANTAIL_SERVICE,"didnt complete a successful pull for too long");return c("ChannelConstants").ERROR_STALE}}else c("FantailLogger").error(c("ChannelConstants").FANTAIL_SERVICE,"ping failed with status: %s",A)},_reportProxyMisguidedMsg:function z(A,B){__p&&__p();c("FantailLogger").error(c("ChannelConstants").FANTAIL_SERVICE,"misguided message to %s meant for %s",B,A);var C=Date.now();if(C-this.lastReportOnMisguidedMsgTime<=q.CHANNEL_PROXY_REPORTING_MIN_INTERVAL)return;this.lastReportOnMisguidedMsgTime=C;var D={received_uid:A,expected_uid:B};if(q.sticky_token)D.sticky_token=q.sticky_token;var E=new(c("URI"))("/err_misguided_msg").setDomain(q.host+"."+q.domain).setPort(q.port).setSecure(new(c("URI"))(window.location.href).isSecure()).setQueryData(D),F=new(c("AjaxRequest"))("GET",E);if(c("AjaxRequest").supportsCORS())F.xhr.withCredentials=true;F.onSuccess=function(G){};F.onError=function(G){};F.onJSON=function(G,H){};F.send()},_probeTest:function z(){__p&&__p();q.streamingCapable=false;var A=[],B={mode:"stream",format:"json"};if(q.sticky_token)B.sticky_token=q.sticky_token;var C=new(c("URI"))("/probe").setDomain(q.fullHost+"."+q.domain).setPort(q.port).setSecure(new(c("URI"))(window.location.href).isSecure()).setQueryData(B);c("BanzaiODS").bumpEntityKey("ChannelManager","probe.attempt");var D=new(c("AjaxRequest"))("GET",C);D.onJSON=function(E,F){__p&&__p();if(E&&E.json&&E.json.t==="heartbeat"){A.push(Date.now());if(A.length>=2){var G=A[1]-A[0];if(G>=q.PROBE_HEARTBEATS_INTERVAL_LOW&&G<=q.PROBE_HEARTBEATS_INTERVAL_HIGH){q.streamingCapable=true;c("BanzaiODS").bumpEntityKey("ChannelManager","probe.switch_to_streaming");k.log("switch_to_streaming","{}")}else c("BanzaiODS").bumpEntityKey("ChannelManager","probe.failure.delayed")}}};D.onSuccess=function(E){if(A.length!=2){q.streamingCapable=false;c("BanzaiODS").bumpEntityKey("ChannelManager","probe.failure.data_loss");k.error("probe_error",JSON.stringify({error:"beats.length = "+A.length}))}c("BanzaiODS").bumpEntityKey("ChannelManager","probe.success");k.log("probe_success","{}")};D.onError=function(E){q.streamingCapable=false;c("BanzaiODS").bumpEntityKey("ChannelManager","probe.failure.error");k.error("probe_error",JSON.stringify(E))};D.send()},_sseProbeTest:function z(){__p&&__p();if(!window.EventSource){c("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.failure.no_event_source");k.log("sse_probe.failure.no_event_source","{}");return}var A=[],B={mode:"sse",format:"json"};if(q.sticky_token)B.sticky_token=q.sticky_token;var C=new(c("URI"))("/sse_probe").setDomain(q.fullHost+"."+q.domain).setPort(q.port).setSecure(new(c("URI"))(window.location.href).isSecure()).setQueryData(B);c("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.attempt");var D=new EventSource(C),E=c("setTimeoutAcrossTransitions")(function(){D.close();c("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.failure.timeout");k.log("sse_probe.failure.timeout","{}")},q.PROBE_HEARTBEATS_INTERVAL_HIGH*6);D.addEventListener("heartbeat",function(F){__p&&__p();A.push(Date.now());if(A.length>=2){var G=A[1]-A[0];if(G>=q.PROBE_HEARTBEATS_INTERVAL_LOW&&G<=q.PROBE_HEARTBEATS_INTERVAL_HIGH){c("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.success");k.log("sse_probe.success","{}")}else{c("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.failure.delayed");k.log("sse_probe.failure.delayed","{}")}c("clearTimeout")(E);D.close()}});D.onerror=function(F){c("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.failure.error");k.error("sse_probe.failure.error",JSON.stringify(F));c("clearTimeout")(E);D.close()}},startChannelManager:function z(){if(c("ChannelInitialData").channelConfig){i.configure(c("ChannelInitialData").channelConfig);if(/shutdown/.test(c("ChannelInitialData").state))i._shutdownHint=c("ChannelConstants")[c("ChannelInitialData").reason];i.init(c("ChannelInitialData").state,c("ChannelInitialData").reason);c("ChatReliabilityInstrumentation").logCHANNEL_INIT();this.startChannelManager=c("emptyFunction")}else c("ChatReliabilityInstrumentation").logCHANNEL_NOCONFIG()}};f.exports=i}),null);
__d("PopoverMenuContextMinWidth",["cx","CSS","Style","shield"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(j){"use strict";this._popoverMenu=j;this._popover=j.getPopover()}i.prototype.enable=function(){"use strict";this._setMenuSubscription=this._popoverMenu.subscribe("setMenu",c("shield")(this._onSetMenu,this))};i.prototype.disable=function(){"use strict";__p&&__p();this._setMenuSubscription.unsubscribe();this._setMenuSubscription=null;if(this._showSubscription){this._showSubscription.unsubscribe();this._showSubscription=null}if(this._menuSubscription){this._menuSubscription.unsubscribe();this._menuSubscription=null}};i.prototype._onSetMenu=function(){"use strict";this._menu=this._popoverMenu.getMenu();this._showSubscription=this._popover.subscribe("show",c("shield")(this._updateWidth,this));var j=this._updateWidth.bind(this);this._menuSubscription=this._menu.subscribe(["change","resize"],function(){setTimeout(j,0)});this._updateWidth()};i.prototype._updateWidth=function(){"use strict";var j=this._menu.getRoot(),k=this._popoverMenu.getTriggerElem(),l=k.offsetWidth;c("Style").set(j,"min-width",l+"px");c("CSS").conditionClass(j,"_575s",l>=j.offsetWidth)};Object.assign(i.prototype,{_setMenuSubscription:null,_showSubscription:null,_menuSubscription:null});f.exports=i}),null);
__d("PhotoStoreCore",[],(function a(b,c,d,e,f,g){__p&&__p();var h={actions:{UPDATE:"update"},_photoCache:{},_postCreateCallbacks:{},getPhotoCache:function i(j){if(!this._photoCache[j])throw new Error("Photo cache requested for unknown set ID");return this._photoCache[j]},hasBeenCreated:function i(j){return!!this._photoCache[j]},clearSetCache:function i(j){delete this._photoCache[j];delete this._postCreateCallbacks[j]},getByIndex:function i(j,k,l){this.getPhotoCache(j).getItemAtIndex(k,l)},getByIndexImmediate:function i(j,k){if(this._photoCache[j])return this._photoCache[j].getItemAtIndexImmediate(k);return undefined},getItemsInAvailableRange:function i(j){var k=this.getAvailableRange(j),l=[];for(var m=k.offset;m<k.length;m++)l.push(this.getByIndexImmediate(j,m));return l},getItemsAfterIndex:function i(j,k,l,m){var n=this.getCursorByIndexImmediate(j,k);this.fetchForward(j,n,l,m)},getAllByIDImmediate:function i(j){var k=Object.keys(this._photoCache);return k.map(function(l){return this.getByIndexImmediate(l,this.getIndexForID(l,j))}.bind(this)).filter(function(l){return!!l})},getIndexForID:function i(j,k){if(this._photoCache[j])return this._photoCache[j].getIndexForID(k);return undefined},getEndIndex:function i(j){var k=this.getAvailableRange(j);return k.offset+k.length-1},getCursorByIndexImmediate:function i(j,k){var l=this.getByIndexImmediate(j,k);if(l)return this._photoCache[j].getCursorForID(l.id);return undefined},hasNextPage:function i(j){var k=this.getCursorByIndexImmediate(j,this.getEndIndex(j));return this.getPhotoCache(j).hasNextPage(k)},getAvailableRange:function i(j){return this.getPhotoCache(j).getAvailableRange()},hasLooped:function i(j){return this.getPhotoCache(j).hasLooped()},fetchForward:function i(j,k,l,m){this.getPhotoCache(j).getItemsAfterCursor(k,l,m)},fetchBackward:function i(j,k,l,m){this.getPhotoCache(j).getItemsBeforeCursor(k,l,m)},executePostCreate:function i(j,k){if(this._photoCache[j])k&&k();else this._postCreateCallbacks[j]=k},runPostCreateCallback:function i(j){var k=this._postCreateCallbacks[j];if(k){k();delete this._postCreateCallbacks[j]}},setPreFetchCallback:function i(j,k){this.getPhotoCache(j).setPreFetchCallback(k)},updateData:function i(j){var k=j.set_id;if(!this._photoCache[k]){this._photoCache[k]=new j.cache_class(j);this.runPostCreateCallback(k)}else if(j.query_metadata.action==h.actions.UPDATE)this._photoCache[k].updateData(j);else this._photoCache[k].addData(j)},updateFeedbackData:function i(j){var k=Object.keys(j);k.forEach(function(l){return h.getAllByIDImmediate(l).forEach(function(m){m.feedback=j[l].feedback})})},reset:function i(){Object.keys(this._photoCache).forEach(function(j){return this.clearSetCache(j)}.bind(this))}};f.exports=h}),null);
__d("PhotoStore",["Arbiter","PhotoStoreCore"],(function a(b,c,d,e,f,g){c("Arbiter").subscribe("update-photos",function(h,i){c("PhotoStoreCore").updateData(i)});f.exports=c("PhotoStoreCore")}),null);
__d("ContextualLayerHideOnScrollOut",["Event","SubscriptionsHandler"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this.$ContextualLayerHideOnScrollOut1=i}h.prototype.enable=function(){"use strict";if(!this.$ContextualLayerHideOnScrollOut2){this.$ContextualLayerHideOnScrollOut2=new(c("SubscriptionsHandler"))();this.$ContextualLayerHideOnScrollOut2.addSubscriptions(this.$ContextualLayerHideOnScrollOut1.subscribe("contextchange",this.$ContextualLayerHideOnScrollOut3.bind(this)),this.$ContextualLayerHideOnScrollOut1.subscribe("show",this.$ContextualLayerHideOnScrollOut4.bind(this)),this.$ContextualLayerHideOnScrollOut1.subscribe("hide",this.$ContextualLayerHideOnScrollOut5.bind(this)))}};h.prototype.disable=function(){"use strict";if(this.$ContextualLayerHideOnScrollOut2){this.$ContextualLayerHideOnScrollOut2.release();this.$ContextualLayerHideOnScrollOut2=undefined}this.$ContextualLayerHideOnScrollOut5()};h.prototype.$ContextualLayerHideOnScrollOut4=function(){"use strict";if(!this.$ContextualLayerHideOnScrollOut6){this.$ContextualLayerHideOnScrollOut7=this.$ContextualLayerHideOnScrollOut1.getContextScrollParent();if(this.$ContextualLayerHideOnScrollOut7===window)return;this.$ContextualLayerHideOnScrollOut6=c("Event").listen(this.$ContextualLayerHideOnScrollOut7,"scroll",this.$ContextualLayerHideOnScrollOut8.bind(this))}};h.prototype.$ContextualLayerHideOnScrollOut5=function(){"use strict";if(this.$ContextualLayerHideOnScrollOut6){this.$ContextualLayerHideOnScrollOut6.remove();this.$ContextualLayerHideOnScrollOut6=undefined;this.$ContextualLayerHideOnScrollOut7=undefined}};h.prototype.$ContextualLayerHideOnScrollOut8=function(){"use strict";var i=this.$ContextualLayerHideOnScrollOut1.getContent().getBoundingClientRect(),j=this.$ContextualLayerHideOnScrollOut7.getBoundingClientRect(),k=i.bottom<=j.top||i.top>=j.bottom,l=i.right<=j.left||i.left>=j.right;if(k||l)this.$ContextualLayerHideOnScrollOut1.hide()};h.prototype.$ContextualLayerHideOnScrollOut3=function(){"use strict";this.detach();if(this.$ContextualLayerHideOnScrollOut1.isShown())this.attach()};f.exports=h}),null);
__d("FluxMixinLegacyInstrumentation",["FluxContainerInstrumentation"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(k){return k.constructor.displayName||k.constructor.name||"FluxMixinLegacy(unknown)"}var i={_callCalculateState:function k(){var l=c("FluxContainerInstrumentation").onCalculateStateStart(h(this)),m=this._FluxMixinLegacyInstrumentationCalculateStateCaller.apply(this,arguments);l&&l();return m},componentWillMount:function k(){if(!this.constructor._FluxMixinLegacyInstrumentationOnInitCalled){c("FluxContainerInstrumentation").onInit(this.constructor);this.constructor._FluxMixinLegacyInstrumentationOnInitCalled=true}},componentDidUpdate:function k(l,m){var n=c("FluxContainerInstrumentation").getDidUpdateCallback();n&&n({name:h(this),props:{prev:l,cur:this.props},state:{prev:m,cur:this.state}})}};function j(k){if(c("FluxContainerInstrumentation").hasInstrumentation()){k.mixins=k.mixins||[];k.mixins.push(i);k._FluxMixinLegacyInstrumentationCalculateStateCaller=k._callCalculateState;delete k._callCalculateState}return k}f.exports={addInstrumentation:j}}),null);
__d("StoreAndPropBasedStateMixin",["invariant","FluxMixinLegacyInstrumentation","StoreBasedStateMixinHelper","setImmediate"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=function(){__p&&__p();for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];return c("FluxMixinLegacyInstrumentation").addInstrumentation({_callCalculateState:function m(n){return this.constructor.calculateState(n)},getInitialState:function m(){return this._callCalculateState(this.props)},componentWillMount:function m(){__p&&__p();this.constructor.calculateState||h(0);this._recalculateStateID=null;var n=function(){if(this.isMounted())this.setState(this._callCalculateState(this.props));this._recalculateStateID=null}.bind(this);this._mixin=new(c("StoreBasedStateMixinHelper"))(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=c("setImmediate")(n)}.bind(this))},componentWillReceiveProps:function m(n){this.setState(this._callCalculateState(n))},componentWillUnmount:function m(){this._mixin.release();this._mixin=null}})}.bind(this);f.exports=i}),null);
__d("Utf16",[],(function a(b,c,d,e,f,g){var h={decode:function i(j){switch(j.length){case 1:return j.charCodeAt(0);case 2:return 65536|(j.charCodeAt(0)-55296)*1024|j.charCodeAt(1)-56320;default:return null}},encode:function i(j){if(j<65536)return String.fromCharCode(j);else return String.fromCharCode(55296+(j-65536>>10))+String.fromCharCode(56320+j%1024)}};f.exports=h}),null);
__d("EmoticonEmojiList",[],(function a(b,c,d,e,f,g){f.exports={names:{":)":"slightsmile",":-)":"slightsmile",":]":"slightsmile","=)":"smile","(:":"slightsmile","(=":"smile",":(":"frown",":-(":"frown",":[":"frown","=(":"frown",")=":"frown",";-P":"winktongue",";P":"winktongue",";-p":"winktongue",";p":"winktongue",":poop:":"poop",":P":"tongue",":-P":"tongue",":-p":"tongue",":p":"tongue","=P":"tongue","=p":"tongue","=D":"grin",":-D":"slightgrin",":D":"slightgrin",":o":"gasp",":-O":"gasp",":O":"gasp",":-o":"gasp",";)":"wink",";-)":"wink","8-)":"glasses","8)":"glasses","B-)":"glasses","B)":"glasses",">:(":"grumpy",">:-(":"grumpy",":/":"unsure",":-/":"unsure",":\\":"unsure",":-\\":"unsure","=/":"unsure","=\\":"unsure",":'(":"cry",":'-(":"cry",":\u2019(":"cry",":\u2019-(":"cry","3:)":"devil","3:-)":"devil","O:)":"angel","O:-)":"angel","0:)":"angel","0:-)":"angel",":*":"kiss",":-*":"kiss",";-*":"winkkiss",";*":"winkkiss","<3":"heart","&lt;3":"heart","\u2665":"heart","^_^":"kiki","^~^":"kiki","-_-":"expressionless",":-|":"squint",":|":"squint",">:o":"upset",">:O":"upset",">:-O":"upset",">:-o":"upset",">_<":"persevere",">.<":"persevere",'<(")':"penguin",O_O:"flushface",o_o:"flushface","0_0":"flushface",T_T:"crying","T-T":"crying",ToT:"crying","T.T":"crying","-3-":"flushkiss","'-_-":"sweating","\u2019-_-":"sweating","(y)":"like",":like:":"like","(Y)":"like","(n)":"dislike","(N)":"dislike"},emote2emojis:{slightsmile:"1f642",smile:"1f60a",frown:"1f61e",winktongue:"1f61c",poop:"1f4a9",tongue:"1f61b",slightgrin:"1f600",grin:"1f603",gasp:"1f62e",wink:"1f609",glasses:"1f60e",grumpy:"1f620",unsure:"1f615",cry:"1f622",devil:"1f608",angel:"1f607",kiss:"1f617",winkkiss:"1f618",heart:"2764",kiki:"1f60a",expressionless:"1f611",squint:"1f610",upset:"1f620",persevere:"1f623",penguin:"1f427",flushface:"1f633",crying:"1f62d",flushkiss:"1f61a",sweating:"1f613",like:"f0000",dislike:"1f44e"},symbols:{slightsmile:":)",smile:"=)",frown:":(",winktongue:";-P",poop:":poop:",tongue:":P",slightgrin:":D",grin:"=D",gasp:":o",wink:";)",glasses:"8-)",grumpy:">:(",unsure:":/",cry:":'(",devil:"3:)",angel:"O:)",kiss:":*",winkkiss:";*",heart:"<3",kiki:"^_^",expressionless:"-_-",squint:":-|",upset:">:o",persevere:">_<",penguin:'<(")',flushface:"O_O",crying:"T_T",flushkiss:"-3-",sweating:"'-_-",like:"(y)",dislike:"(n)"},regexp:/(^|[\s\'\".])(:\)(?!\))|:\-\)(?!\))|:\]|=\)(?!\))|\(:|\(=|:\(|:\-\(|:\[|=\(|\)=|;P|;\-P|;\-p|;p|:poop:|:P|:\-P|:\-p|:p|=P|=p|=D|:\-D|:D|:o|:\-O|:O|:\-o|;\)(?!\))|;\-\)(?!\))|8\-\)(?!\))|B\-\)(?!\))|B\)(?!\))|8\)(?!\))|>:\(|>:\-\(|:\/|:\-\/|:\\|:\-\\|=\/|=\\|:\'\(|:\'\-\(|:\u2019\(|:\u2019\-\(|3:\)(?!\))|3:\-\)(?!\))|O:\)(?!\))|O:\-\)(?!\))|0:\)(?!\))|0:\-\)(?!\))|:\*|:\-\*|;\*|;\-\*|<3|&lt;3|\u2665|\^_\^|\^~\^|\-_\-|:\-\||:\||>:o|>:O|>:\-O|>:\-o|>_<|>\.<|<\(\"\)(?!\))|O_O|o_o|0_0|T_T|T\-T|ToT|T\.T|\-3\-|\'\-_\-|\u2019\-_\-|\(y\)(?!\))|:like:|\(Y\)(?!\))|\(n\)(?!\))|\(N\)(?!\)))([\s\'\".,!?]|<br>|$)/,noncapturingRegexp:/(?:^|[\s\'\".])(:\)(?!\))|:\-\)(?!\))|:\]|=\)(?!\))|\(:|\(=|:\(|:\-\(|:\[|=\(|\)=|;P|;\-P|;\-p|;p|:poop:|:P|:\-P|:\-p|:p|=P|=p|=D|:\-D|:D|:o|:\-O|:O|:\-o|;\)(?!\))|;\-\)(?!\))|8\-\)(?!\))|B\-\)(?!\))|B\)(?!\))|8\)(?!\))|>:\(|>:\-\(|:\/|:\-\/|:\\|:\-\\|=\/|=\\|:\'\(|:\'\-\(|:\u2019\(|:\u2019\-\(|3:\)(?!\))|3:\-\)(?!\))|O:\)(?!\))|O:\-\)(?!\))|0:\)(?!\))|0:\-\)(?!\))|:\*|:\-\*|;\*|;\-\*|<3|&lt;3|\u2665|\^_\^|\^~\^|\-_\-|:\-\||:\||>:o|>:O|>:\-O|>:\-o|>_<|>\.<|<\(\"\)(?!\))|O_O|o_o|0_0|T_T|T\-T|ToT|T\.T|\-3\-|\'\-_\-|\u2019\-_\-|\(y\)(?!\))|:like:|\(Y\)(?!\))|\(n\)(?!\))|\(N\)(?!\)))(?:[\s\'\".,!?]|<br>|$)/}}),null);
__d("filterSet",["Set"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j){__p&&__p();var k=new(c("Set"))();for(var l=i,m=Array.isArray(l),n=0,l=m?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var o;if(m){if(n>=l.length)break;o=l[n++]}else{n=l.next();if(n.done)break;o=n.value}var p=o;if(j(p))k.add(p)}return k}f.exports=h}),null);
__d("MercuryTypeaheadConstants",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({COMPOSER_FRIENDS_MAX:4,COMPOSER_FB4C_MAX:8,COMPOSER_NON_FRIENDS_MAX:2,COMPOSER_MESSENGER_ONLY_CONTACT_MAX:4,COMPOSER_SHOW_MORE_LIMIT:2,COMPOSER_THREADS_INITIAL_LIMIT:2,COMPOSER_CHATTAB_MAX:5,COMPOSER_PAGES_MAX:5,COMPOSER_WM_MAX:23,USER_TYPE:"user",PAGE_TYPE:"page",THREAD_TYPE:"thread",HEADER_TYPE:"header",SEARCH_TYPE:"search",FRIEND_TYPE:"friend",NON_FRIEND_TYPE:"non_friend",FB4C_TYPE:"fb4c",MEETING_ROOM_PAGE_TYPE:"meeting_room_page",COMMERCE_PAGE_TYPE:"commerce_page",INTERNAL_BOT_PAGE_TYPE:"internal_bot_page",GAME_TYPE:"game",WORKPLACE_BOT_CATEGORY_TYPE:"WORKPLACE_BOT",VALID_EMAIL:"^([A-Z0-9._%+-]+@((?!facebook\\.com))[A-Z0-9.-]+\\.[A-Z]{2,4}|(([A-Z._%+-]+[A-Z0-9._%+-]*)|([A-Z0-9._%+-]+[A-Z._%+-]+[A-Z0-9._%+-]*))@(?:facebook\\.com))$"})}),null);
__d("MessagingSourceEnum",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CHAT_ORCA:"source:chat:orca",CHAT_IPHONE:"source:chat:iphone",CHAT_JABBER:"source:chat:jabber",CHAT_MEEBO:"source:chat:meebo",CHAT_WEB:"source:chat:web",CHAT_TEST:"source:chat:test",CHAT_FORWARD_DIALOG:"source:chat:forward",CHAT:"source:chat",CONTACT_ADD_MUTATION:"source:contact_add:graphql_mutation",CONTACT_ADD_CYMK:"source:contact_add:cymk_suggestion",CUSTOMER_CHAT_PLUGIN:"source:discovery:customer_chat_plugin",EMAIL:"source:email",EVENT_MESSAGE_BLAST:"source:event_message_blast",EVENT_TICKETING:"source:event_ticket",EVENT_REMINDERS:"source:event_reminders",FUNDRAISER_MESSAGE_BLAST:"source:fundraiser_message_blast",GENERIC_ADMIN_TEXT:"source:generic_admin_text",GIGABOXX_API:"source:gigaboxx:api",GIGABOXX_BLAST:"source:gigaboxx:blast",GIGABOXX_EMAIL_REPLY:"source:gigaboxx:emailreply",GIGABOXX_MOBILE:"source:gigaboxx:mobile",GIGABOXX_WAP:"source:gigaboxx:wap",GIGABOXX_WEB:"source:gigaboxx:web",INVITE:"source:invite",LEIA:"source:leia",MESSENGER_WEB:"source:messenger:web",MESSENGER_WEB_SEARCH:"source:messenger:web_search",SAM_UFI:"source:sam:ufi",SHARE_DIALOG:"source:share:dialog",SEND_PLUGIN:"source:sendplugin",SMS:"source:sms",TEST:"source:test",TITAN_WAP:"source:titan:wap",TITAN_M_BASIC:"source:titan:m_basic",TITAN_M_FREE:"source:titan:m_free_basic",TITAN_M_JAPAN:"source:titan:m_japan",TITAN_M_MINI:"source:titan:m_mini",TITAN_M_TOUCH:"source:titan:m_touch",TITAN_M_APP:"source:titan:m_app",TITAN_M_TABLET:"source:titan:m_tablet",TITAN_M_ZERO:"source:titan:m_zero",TITAN_M_TALK:"source:titan:m_talk",TITAN_WEB:"source:titan:web",TITAN_FACEWEB_ANDROID:"source:titan:faceweb_android",TITAN_FACEWEB_BUFFY:"source:titan:faceweb_buffy",TITAN_FACEWEB_IPAD:"source:titan:faceweb_ipad",TITAN_FACEWEB_IPHONE:"source:titan:faceweb_iphone",TITAN_FACEWEB_UNKNOWN:"source:titan:faceweb_unknown",TITAN_API:"source:titan:api",TITAN_API_MOBILE:"source:titan:api_mobile",TITAN_ORCA:"source:titan:orca",TITAN_EMAIL_REPLY:"source:titan:emailreply",MOBILE:"source:mobile",PAGE_PLATFORM_API:"source:page_platform_api",PAGE_UNIFIED_INBOX:"source:page_unified_inbox",UNKNOWN:"source:unknown",WEB:"source:web",HELPCENTER:"source:helpcenter",NEW_SHARE_DIALOG:"source:share:dialog:new",PAID_PROMOTION:"source:paid_promotion",BUFFY_SMS:"source:buffy:sms",WEBRTC_MOBILE:"source:webrtc:mobile",MESSENGER_COMMERCE:"source:messenger:commerce",MESSENGER_BOT:"source:bot",MESSENGER_EMPLOYEE_ONLY_BOT:"source:bot:employee_only",MESSENGER_OMNIM:"source:messenger:omnim",PAGES_PRIVATE_REPLY:"source:pages:private_reply",MESSENGER_FORWARD_DIALOG:"source:messenger:forward",MESSENGER_AD:"source:messenger:ad",MARKETPLACE:"source:marketplace",MESSENGER_LEAD_GEN:"source:messenger:lead_gen",PAGES_MESSAGE_SHORTLINK:"source:pages:message_shortlink",STICKER_SUBSCRIBE:"source:messenger:sticker_subscribe",PHOTO_TAG:"source:messenger:photo_tag",INTERNAL_TEST_PENDING:"source:internal:test_pending",JOB_SEARCH_APPLICATION:"source:job_search:application",MESSENGER_JOINABLE_LINK:"source:messenger:joinable_link",MESSENGER_ADD_WITH_APPROVAL:"source:messenger:add_with_approval",MESSENGER_SMS_BRIDGE_CONVERT:"source:messenger:sms_bridge_conversion",TINCAN_ORCA:"source:tincan:orca",TINCAN_IOS:"source:tincan:ios",TINCAN_UNKNOWN:"source:tincan:unknown",FACEBOOK_GROUPS_CHANNELS:"source:groups:channels",GROUP_COMMERCE:"source:group_commerce",INTERNAL_TOOL:"source:internal:tool",PAGES_PLATFORM:"source:pages:platform",PAGES_RECOMMENDATION:"source:pages:recommendation",PAGES_ORDER_MANAGEMENT:"source:pages:order_management",PAGE_AUTO_RESPONSE:"source:pages:auto_response",PAGES_INVITE:"source:pages:invite",PAGES_CHAT_EXTENSION:"source:pages:chat_extension",SAVED_CHAT_EXTENSION:"source:saved:chat_extension",CREATOR_PAGE_INITIATE_TO_CREATOR_PAGE:"source:pages:creator_page_initiate_to_creator_page",LIVE_VIDEO_CHAT:"source:live_video_chat",FRIENDING_ADMIN_BUMP:"source:messenger_growth:friending_admin_bump",NEW_MESSENGER_USER_ADMIN_BUMP:"source:messenger_growth:new_messenger_user_admin_bump",EVENT_UPCOMING_BUMP:"source:messenger_growth:event_upcoming_bump",PHOTO_TAG_BUMP:"source:messenger_growth:photo_tag_bump",WALL_POST_BUMP:"source:messenger_growth:wall_post_bump",CUSTOMIZATION_UPSELL_BUMP:"source:messenger_growth:customization_upsell_bump",PAGE_COMMENT_MSG:"source:pages:question_triggered_convo",COMMENT_PIVOT:"source:messenger_growth:comment_pivot",PAGE_HOVERCARD:"source:pages:hovercard",INSTANT_GAMES:"source:instant_games",PAGE_EMAIL_REPLY:"source:pages:email_reply",PAGE_HOME_PAGE_PANEL:"source:page_home_page_panel",GROUPSYNC_MESSENGER_GROUP_CREATE:"source:groupsync:messenger_group_create",GROUPSYNC_SYNC_FROM_FB:"source:groupsync:sync_from_fb",GROUPSYNC_NAMING:"source:groupsync:naming",PAGE_PQI_MESSAGE:"source:pages:pqi_message"})}),null);
__d("PhotoResizeModeConst",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CONTAIN:"s",COVER:"p"})}),null);
__d("MercurySyncDeltaTypes",[],(function a(b,c,d,e,f,g){"use strict";var h={AdminAddedToGroupThread:"AdminAddedToGroupThread",AdminRemovedFromGroupThread:"AdminRemovedFromGroupThread",AdminTextMessage:"AdminTextMessage",ChangeViewerStatus:"ChangeViewerStatus",DeliveryReceipt:"DeliveryReceipt",ForcedFetch:"ForcedFetch",MarkRead:"MarkRead",MarkUnread:"MarkUnread",MarkFolderSeen:"MarkFolderSeen",MessageDelete:"MessageDelete",NewMessage:"NewMessage",NoOp:"NoOp",PagesManagerEvent:"PagesManagerEvent",ParticipantLeftGroupThread:"ParticipantLeftGroupThread",ParticipantsAddedToGroupThread:"ParticipantsAddedToGroupThread",ReadReceipt:"ReadReceipt",ReplaceMessage:"ReplaceMessage",RTCEventLog:"RTCEventLog",ThreadAction:"ThreadAction",ThreadDelete:"ThreadDelete",ThreadFolder:"ThreadFolder",ThreadMuteSettings:"ThreadMuteSettings",ThreadName:"ThreadName",JoinableMode:"JoinableMode",ApprovalMode:"ApprovalMode",ApprovalQueue:"ApprovalQueue",ClientPayload:"ClientPayload",GenieMessage:"GenieMessage",MontageMessage:"MontageMessage",RtcCallData:"RtcCallData"};f.exports=h}),null);
__d("isEventSupported",["fbjs/lib/ExecutionEnvironment"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h;if(c("fbjs/lib/ExecutionEnvironment").canUseDOM)h=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==true;function i(j,k){__p&&__p();if(!c("fbjs/lib/ExecutionEnvironment").canUseDOM||k&&!("addEventListener"in document))return false;var l="on"+j,m=l in document;if(!m){var n=document.createElement("div");n.setAttribute(l,"return;");m=typeof n[l]==="function"}if(!m&&h&&j==="wheel")m=document.implementation.hasFeature("Events.wheel","3.0");return m}f.exports=i}),null);